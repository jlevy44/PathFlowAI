

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Welcome to PathFlowAI’s documentation! &mdash; PathFlowAI 0.1.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> PathFlowAI
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Welcome to PathFlowAI’s documentation!</a><ul>
<li><a class="reference internal" href="#pathflowai-preprocess">pathflowai-preprocess</a><ul>
<li><a class="reference internal" href="#pathflowai-preprocess-alter-masks">alter-masks</a></li>
<li><a class="reference internal" href="#pathflowai-preprocess-collapse-annotations">collapse-annotations</a></li>
<li><a class="reference internal" href="#pathflowai-preprocess-preprocess-pipeline">preprocess-pipeline</a></li>
<li><a class="reference internal" href="#pathflowai-preprocess-remove-basename-from-db">remove-basename-from-db</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pathflowai-visualize">pathflowai-visualize</a><ul>
<li><a class="reference internal" href="#pathflowai-visualize-extract-patch">extract-patch</a></li>
<li><a class="reference internal" href="#pathflowai-visualize-overlay-new-annotations">overlay-new-annotations</a></li>
<li><a class="reference internal" href="#pathflowai-visualize-plot-embeddings">plot-embeddings</a></li>
<li><a class="reference internal" href="#pathflowai-visualize-plot-image">plot-image</a></li>
<li><a class="reference internal" href="#pathflowai-visualize-plot-image-umap-embeddings">plot-image-umap-embeddings</a></li>
<li><a class="reference internal" href="#pathflowai-visualize-plot-mask-mpl">plot-mask-mpl</a></li>
<li><a class="reference internal" href="#pathflowai-visualize-plot-predictions">plot-predictions</a></li>
<li><a class="reference internal" href="#pathflowai-visualize-shapley-plot">shapley-plot</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pathflowai-train-model">pathflowai-train_model</a><ul>
<li><a class="reference internal" href="#pathflowai-train-model-train-model">train-model</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pathflowai-monitor">pathflowai-monitor</a><ul>
<li><a class="reference internal" href="#pathflowai-monitor-monitor-usage">monitor-usage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#datasets-py">datasets.py</a></li>
<li><a class="reference internal" href="#losses-py">losses.py</a></li>
<li><a class="reference internal" href="#models-py">models.py</a></li>
<li><a class="reference internal" href="#sampler-py">sampler.py</a></li>
<li><a class="reference internal" href="#schedulers-py">schedulers.py</a></li>
<li><a class="reference internal" href="#visualize-py">visualize.py</a></li>
<li><a class="reference internal" href="#utils-py">utils.py</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">PathFlowAI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Welcome to PathFlowAI’s documentation!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-pathflowai-s-documentation">
<h1>Welcome to PathFlowAI’s documentation!<a class="headerlink" href="#welcome-to-pathflowai-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<a class="reference internal image-reference" href="_static/1.jpeg"><img alt="Download" class="align-center" src="_static/1.jpeg" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_static/2.jpeg"><img alt="Download" class="align-center" src="_static/2.jpeg" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_static/3.jpeg"><img alt="Download" class="align-center" src="_static/3.jpeg" style="width: 480.0px; height: 360.0px;" /></a>
<a class="reference internal image-reference" href="_static/4.jpeg"><img alt="Download" class="align-center" src="_static/4.jpeg" style="width: 480.0px; height: 360.0px;" /></a>
<div class="section" id="pathflowai-preprocess">
<h2>pathflowai-preprocess<a class="headerlink" href="#pathflowai-preprocess" title="Permalink to this headline">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-preprocess <span class="o">[</span>OPTIONS<span class="o">]</span> COMMAND <span class="o">[</span>ARGS<span class="o">]</span>...
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-version">
<code class="sig-name descname">--version</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-version" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the version and exit.</p>
</dd></dl>

<div class="section" id="pathflowai-preprocess-alter-masks">
<h3>alter-masks<a class="headerlink" href="#pathflowai-preprocess-alter-masks" title="Permalink to this headline">¶</a></h3>
<p>Map list of values to other values in mask.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-preprocess alter-masks <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-alter-masks-i">
<code class="sig-name descname">-i</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--mask_dir</code><code class="sig-prename descclassname"> &lt;mask_dir&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-alter-masks-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Input directory for masks.  [default: ./inputs/]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-alter-masks-o">
<code class="sig-name descname">-o</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--output_dir</code><code class="sig-prename descclassname"> &lt;output_dir&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-alter-masks-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Output directory for new masks.  [default: ./outputs/]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-alter-masks-fr">
<code class="sig-name descname">-fr</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--from_annotations</code><code class="sig-prename descclassname"> &lt;from_annotations&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-alter-masks-fr" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotations to switch from.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-alter-masks-to">
<code class="sig-name descname">-to</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--to_annotations</code><code class="sig-prename descclassname"> &lt;to_annotations&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-alter-masks-to" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotations to switch to.  [default: ]</p>
</dd></dl>

</div>
<div class="section" id="pathflowai-preprocess-collapse-annotations">
<h3>collapse-annotations<a class="headerlink" href="#pathflowai-preprocess-collapse-annotations" title="Permalink to this headline">¶</a></h3>
<p>Adds annotation classes areas to other annotation classes in SQL DB when getting rid of some annotation classes.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-preprocess collapse-annotations <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-collapse-annotations-i">
<code class="sig-name descname">-i</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--input_patch_db</code><code class="sig-prename descclassname"> &lt;input_patch_db&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-collapse-annotations-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Input db.  [default: patch_info_input.db]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-collapse-annotations-o">
<code class="sig-name descname">-o</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--output_patch_db</code><code class="sig-prename descclassname"> &lt;output_patch_db&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-collapse-annotations-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Output db.  [default: patch_info_output.db]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-collapse-annotations-fr">
<code class="sig-name descname">-fr</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--from_annotations</code><code class="sig-prename descclassname"> &lt;from_annotations&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-collapse-annotations-fr" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotations to switch from.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-collapse-annotations-to">
<code class="sig-name descname">-to</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--to_annotations</code><code class="sig-prename descclassname"> &lt;to_annotations&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-collapse-annotations-to" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotations to switch to.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-collapse-annotations-ps">
<code class="sig-name descname">-ps</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--patch_size</code><code class="sig-prename descclassname"> &lt;patch_size&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-collapse-annotations-ps" title="Permalink to this definition">¶</a></dt>
<dd><p>Patch size.  [default: 224]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-collapse-annotations-rb">
<code class="sig-name descname">-rb</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--remove_background_annotation</code><code class="sig-prename descclassname"> &lt;remove_background_annotation&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-collapse-annotations-rb" title="Permalink to this definition">¶</a></dt>
<dd><p>If selected, removes 100% background patches based on this annotation.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-collapse-annotations-ma">
<code class="sig-name descname">-ma</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--max_background_area</code><code class="sig-prename descclassname"> &lt;max_background_area&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-collapse-annotations-ma" title="Permalink to this definition">¶</a></dt>
<dd><p>Max background area before exclusion.  [default: 0.05]</p>
</dd></dl>

</div>
<div class="section" id="pathflowai-preprocess-preprocess-pipeline">
<h3>preprocess-pipeline<a class="headerlink" href="#pathflowai-preprocess-preprocess-pipeline" title="Permalink to this headline">¶</a></h3>
<p>Preprocessing pipeline that stores into ZARR format, performs optional mask adjustment, and stores patch-level information into SQL DB.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-preprocess preprocess-pipeline <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-npy">
<code class="sig-name descname">-npy</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--img2npy</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-npy" title="Permalink to this definition">¶</a></dt>
<dd><p>Image to numpy for faster read.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-b">
<code class="sig-name descname">-b</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--basename</code><code class="sig-prename descclassname"> &lt;basename&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-b" title="Permalink to this definition">¶</a></dt>
<dd><p>Basename of patches.  [default: A01]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-i">
<code class="sig-name descname">-i</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--input_dir</code><code class="sig-prename descclassname"> &lt;input_dir&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Input directory for patches.  [default: ./inputs/]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-a">
<code class="sig-name descname">-a</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--annotations</code><code class="sig-prename descclassname"> &lt;annotations&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-a" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotations in image in order.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-pr">
<code class="sig-name descname">-pr</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--preprocess</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-pr" title="Permalink to this definition">¶</a></dt>
<dd><p>Run preprocessing pipeline.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-pa">
<code class="sig-name descname">-pa</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--patches</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-pa" title="Permalink to this definition">¶</a></dt>
<dd><p>Add patches to SQL.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-t">
<code class="sig-name descname">-t</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--threshold</code><code class="sig-prename descclassname"> &lt;threshold&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-t" title="Permalink to this definition">¶</a></dt>
<dd><p>Threshold to remove non-purple slides.  [default: 0.05]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-ps">
<code class="sig-name descname">-ps</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--patch_size</code><code class="sig-prename descclassname"> &lt;patch_size&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-ps" title="Permalink to this definition">¶</a></dt>
<dd><p>Patch size.  [default: 224]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-it">
<code class="sig-name descname">-it</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--intensity_threshold</code><code class="sig-prename descclassname"> &lt;intensity_threshold&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-it" title="Permalink to this definition">¶</a></dt>
<dd><p>Intensity threshold to rate a pixel as non-white.  [default: 100.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-g">
<code class="sig-name descname">-g</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--generate_finetune_segmentation</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-g" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate patches for one segmentation mask class for targeted finetuning.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-tc">
<code class="sig-name descname">-tc</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--target_segmentation_class</code><code class="sig-prename descclassname"> &lt;target_segmentation_class&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-tc" title="Permalink to this definition">¶</a></dt>
<dd><p>Segmentation Class to finetune on, output patches to another db.  [default: 0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-tt">
<code class="sig-name descname">-tt</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--target_threshold</code><code class="sig-prename descclassname"> &lt;target_threshold&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-tt" title="Permalink to this definition">¶</a></dt>
<dd><p>Threshold to include target for segmentation if saving one class.  [default: 0.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-odb">
<code class="sig-name descname">-odb</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--out_db</code><code class="sig-prename descclassname"> &lt;out_db&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-odb" title="Permalink to this definition">¶</a></dt>
<dd><p>Output patch database.  [default: ./patch_info.db]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-am">
<code class="sig-name descname">-am</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--adjust_mask</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-am" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove additional background regions from annotation mask.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-nn">
<code class="sig-name descname">-nn</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--n_neighbors</code><code class="sig-prename descclassname"> &lt;n_neighbors&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-nn" title="Permalink to this definition">¶</a></dt>
<dd><p>If adjusting mask, number of neighbors connectivity to remove.  [default: 5]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-bp">
<code class="sig-name descname">-bp</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--basic_preprocess</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-bp" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic preprocessing pipeline, annotation areas are not saved. Used for benchmarking tool against comparable pipelines  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-ei">
<code class="sig-name descname">-ei</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--entire_image</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-ei" title="Permalink to this definition">¶</a></dt>
<dd><p>Store entire image in central db rather than patches.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-preprocess-pipeline-nz">
<code class="sig-name descname">-nz</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--no_zarr</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-preprocess-pipeline-nz" title="Permalink to this definition">¶</a></dt>
<dd><p>Don’t save zarr format file.  [default: False]</p>
</dd></dl>

</div>
<div class="section" id="pathflowai-preprocess-remove-basename-from-db">
<h3>remove-basename-from-db<a class="headerlink" href="#pathflowai-preprocess-remove-basename-from-db" title="Permalink to this headline">¶</a></h3>
<p>Removes basename/ID from SQL DB.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-preprocess remove-basename-from-db <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-remove-basename-from-db-i">
<code class="sig-name descname">-i</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--input_patch_db</code><code class="sig-prename descclassname"> &lt;input_patch_db&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-remove-basename-from-db-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Input db.  [default: patch_info_input.db]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-remove-basename-from-db-o">
<code class="sig-name descname">-o</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--output_patch_db</code><code class="sig-prename descclassname"> &lt;output_patch_db&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-remove-basename-from-db-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Output db.  [default: patch_info_output.db]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-remove-basename-from-db-b">
<code class="sig-name descname">-b</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--basename</code><code class="sig-prename descclassname"> &lt;basename&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-remove-basename-from-db-b" title="Permalink to this definition">¶</a></dt>
<dd><p>Basename.  [default: A01]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-preprocess-remove-basename-from-db-ps">
<code class="sig-name descname">-ps</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--patch_size</code><code class="sig-prename descclassname"> &lt;patch_size&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-preprocess-remove-basename-from-db-ps" title="Permalink to this definition">¶</a></dt>
<dd><p>Patch size.  [default: 224]</p>
</dd></dl>

</div>
</div>
<div class="section" id="pathflowai-visualize">
<h2>pathflowai-visualize<a class="headerlink" href="#pathflowai-visualize" title="Permalink to this headline">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-visualize <span class="o">[</span>OPTIONS<span class="o">]</span> COMMAND <span class="o">[</span>ARGS<span class="o">]</span>...
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-visualize-version">
<code class="sig-name descname">--version</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-visualize-version" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the version and exit.</p>
</dd></dl>

<div class="section" id="pathflowai-visualize-extract-patch">
<h3>extract-patch<a class="headerlink" href="#pathflowai-visualize-extract-patch" title="Permalink to this headline">¶</a></h3>
<p>Extract image of patch of any size/location and output to image file</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-visualize extract-patch <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-visualize-extract-patch-i">
<code class="sig-name descname">-i</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--input_dir</code><code class="sig-prename descclassname"> &lt;input_dir&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-extract-patch-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Input directory for patches.  [default: ./inputs/]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-extract-patch-b">
<code class="sig-name descname">-b</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--basename</code><code class="sig-prename descclassname"> &lt;basename&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-extract-patch-b" title="Permalink to this definition">¶</a></dt>
<dd><p>Basename of patches.  [default: A01]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-extract-patch-p">
<code class="sig-name descname">-p</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--patch_info_file</code><code class="sig-prename descclassname"> &lt;patch_info_file&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-extract-patch-p" title="Permalink to this definition">¶</a></dt>
<dd><p>Datbase containing all patches  [default: patch_info.db]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-extract-patch-ps">
<code class="sig-name descname">-ps</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--patch_size</code><code class="sig-prename descclassname"> &lt;patch_size&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-extract-patch-ps" title="Permalink to this definition">¶</a></dt>
<dd><p>Patch size.  [default: 224]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-extract-patch-x">
<code class="sig-name descname">-x</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--x</code><code class="sig-prename descclassname"> &lt;x&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-extract-patch-x" title="Permalink to this definition">¶</a></dt>
<dd><p>X Coordinate of patch.  [default: 0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-extract-patch-y">
<code class="sig-name descname">-y</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--y</code><code class="sig-prename descclassname"> &lt;y&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-extract-patch-y" title="Permalink to this definition">¶</a></dt>
<dd><p>Y coordinate of patch.  [default: 0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-extract-patch-o">
<code class="sig-name descname">-o</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--outputfname</code><code class="sig-prename descclassname"> &lt;outputfname&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-extract-patch-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Output extracted image.  [default: ./output_image.png]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-extract-patch-s">
<code class="sig-name descname">-s</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--segmentation</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-visualize-extract-patch-s" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot segmentations.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-extract-patch-sc">
<code class="sig-name descname">-sc</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--n_segmentation_classes</code><code class="sig-prename descclassname"> &lt;n_segmentation_classes&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-extract-patch-sc" title="Permalink to this definition">¶</a></dt>
<dd><p>Number segmentation classes  [default: 4]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-extract-patch-c">
<code class="sig-name descname">-c</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--custom_segmentation</code><code class="sig-prename descclassname"> &lt;custom_segmentation&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-extract-patch-c" title="Permalink to this definition">¶</a></dt>
<dd><p>Add custom segmentation map from prediction, in npy  [default: ]</p>
</dd></dl>

</div>
<div class="section" id="pathflowai-visualize-overlay-new-annotations">
<h3>overlay-new-annotations<a class="headerlink" href="#pathflowai-visualize-overlay-new-annotations" title="Permalink to this headline">¶</a></h3>
<p>Custom annotations, in format [Point: x, y, Point: x, y … ] one line like this per polygon, overlap these polygons on top of WSI.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-visualize overlay-new-annotations <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-visualize-overlay-new-annotations-i">
<code class="sig-name descname">-i</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--img_file</code><code class="sig-prename descclassname"> &lt;img_file&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-overlay-new-annotations-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Input image.  [default: image.txt]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-overlay-new-annotations-a">
<code class="sig-name descname">-a</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--annotation_txt</code><code class="sig-prename descclassname"> &lt;annotation_txt&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-overlay-new-annotations-a" title="Permalink to this definition">¶</a></dt>
<dd><p>Column of annotations  [default: annotation.txt]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-overlay-new-annotations-ocf">
<code class="sig-name descname">-ocf</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--original_compression_factor</code><code class="sig-prename descclassname"> &lt;original_compression_factor&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-overlay-new-annotations-ocf" title="Permalink to this definition">¶</a></dt>
<dd><p>How much compress image.  [default: 1.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-overlay-new-annotations-cf">
<code class="sig-name descname">-cf</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--compression_factor</code><code class="sig-prename descclassname"> &lt;compression_factor&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-overlay-new-annotations-cf" title="Permalink to this definition">¶</a></dt>
<dd><p>How much compress image.  [default: 3.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-overlay-new-annotations-o">
<code class="sig-name descname">-o</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--outputfilename</code><code class="sig-prename descclassname"> &lt;outputfilename&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-overlay-new-annotations-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Output extracted image.  [default: ./output_image.png]</p>
</dd></dl>

</div>
<div class="section" id="pathflowai-visualize-plot-embeddings">
<h3>plot-embeddings<a class="headerlink" href="#pathflowai-visualize-plot-embeddings" title="Permalink to this headline">¶</a></h3>
<p>Perform UMAP embeddings of patches and plot using plotly.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-visualize plot-embeddings <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-embeddings-i">
<code class="sig-name descname">-i</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--embeddings_file</code><code class="sig-prename descclassname"> &lt;embeddings_file&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-embeddings-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Embeddings.  [default: predictions/embeddings.pkl]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-embeddings-o">
<code class="sig-name descname">-o</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--plotly_output_file</code><code class="sig-prename descclassname"> &lt;plotly_output_file&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-embeddings-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotly output file.  [default: predictions/embeddings.html]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-embeddings-a">
<code class="sig-name descname">-a</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--annotations</code><code class="sig-prename descclassname"> &lt;annotations&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-embeddings-a" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiple annotations to color image.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-embeddings-rb">
<code class="sig-name descname">-rb</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--remove_background_annotation</code><code class="sig-prename descclassname"> &lt;remove_background_annotation&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-embeddings-rb" title="Permalink to this definition">¶</a></dt>
<dd><p>If selected, removes 100% background patches based on this annotation.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-embeddings-ma">
<code class="sig-name descname">-ma</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--max_background_area</code><code class="sig-prename descclassname"> &lt;max_background_area&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-embeddings-ma" title="Permalink to this definition">¶</a></dt>
<dd><p>Max background area before exclusion.  [default: 0.05]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-embeddings-b">
<code class="sig-name descname">-b</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--basename</code><code class="sig-prename descclassname"> &lt;basename&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-embeddings-b" title="Permalink to this definition">¶</a></dt>
<dd><p>Basename of patches.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-embeddings-nn">
<code class="sig-name descname">-nn</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--n_neighbors</code><code class="sig-prename descclassname"> &lt;n_neighbors&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-embeddings-nn" title="Permalink to this definition">¶</a></dt>
<dd><p>Number nearest neighbors.  [default: 8]</p>
</dd></dl>

</div>
<div class="section" id="pathflowai-visualize-plot-image">
<h3>plot-image<a class="headerlink" href="#pathflowai-visualize-plot-image" title="Permalink to this headline">¶</a></h3>
<p>Plots the whole slide image supplied.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-visualize plot-image <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-image-i">
<code class="sig-name descname">-i</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--image_file</code><code class="sig-prename descclassname"> &lt;image_file&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-image-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Input image file.  [default: ./inputs/a.svs]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-image-cf">
<code class="sig-name descname">-cf</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--compression_factor</code><code class="sig-prename descclassname"> &lt;compression_factor&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-image-cf" title="Permalink to this definition">¶</a></dt>
<dd><p>How much compress image.  [default: 3.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-image-o">
<code class="sig-name descname">-o</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--outputfname</code><code class="sig-prename descclassname"> &lt;outputfname&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-image-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Output extracted image.  [default: ./output_image.png]</p>
</dd></dl>

</div>
<div class="section" id="pathflowai-visualize-plot-image-umap-embeddings">
<h3>plot-image-umap-embeddings<a class="headerlink" href="#pathflowai-visualize-plot-image-umap-embeddings" title="Permalink to this headline">¶</a></h3>
<p>Plots a UMAP embedding where each point is its corresponding patch.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-visualize plot-image-umap-embeddings <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-image-umap-embeddings-i">
<code class="sig-name descname">-i</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--input_dir</code><code class="sig-prename descclassname"> &lt;input_dir&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-image-umap-embeddings-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Input directory for patches.  [default: ./inputs/]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-image-umap-embeddings-e">
<code class="sig-name descname">-e</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--embeddings_file</code><code class="sig-prename descclassname"> &lt;embeddings_file&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-image-umap-embeddings-e" title="Permalink to this definition">¶</a></dt>
<dd><p>Embeddings.  [default: predictions/embeddings.pkl]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-image-umap-embeddings-b">
<code class="sig-name descname">-b</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--basename</code><code class="sig-prename descclassname"> &lt;basename&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-image-umap-embeddings-b" title="Permalink to this definition">¶</a></dt>
<dd><p>Basename of patches.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-image-umap-embeddings-o">
<code class="sig-name descname">-o</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--outputfilename</code><code class="sig-prename descclassname"> &lt;outputfilename&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-image-umap-embeddings-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Embedding visualization.  [default: predictions/shap_plots.png]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-image-umap-embeddings-mpl">
<code class="sig-name descname">-mpl</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--mpl_scatter</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-image-umap-embeddings-mpl" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot segmentations.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-image-umap-embeddings-rb">
<code class="sig-name descname">-rb</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--remove_background_annotation</code><code class="sig-prename descclassname"> &lt;remove_background_annotation&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-image-umap-embeddings-rb" title="Permalink to this definition">¶</a></dt>
<dd><p>If selected, removes all background patches from this annotation.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-image-umap-embeddings-ma">
<code class="sig-name descname">-ma</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--max_background_area</code><code class="sig-prename descclassname"> &lt;max_background_area&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-image-umap-embeddings-ma" title="Permalink to this definition">¶</a></dt>
<dd><p>Max background area before exclusion.  [default: 0.05]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-image-umap-embeddings-z">
<code class="sig-name descname">-z</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--zoom</code><code class="sig-prename descclassname"> &lt;zoom&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-image-umap-embeddings-z" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of images.  [default: 0.05]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-image-umap-embeddings-nn">
<code class="sig-name descname">-nn</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--n_neighbors</code><code class="sig-prename descclassname"> &lt;n_neighbors&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-image-umap-embeddings-nn" title="Permalink to this definition">¶</a></dt>
<dd><p>Number nearest neighbors.  [default: 8]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-image-umap-embeddings-sc">
<code class="sig-name descname">-sc</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--sort_col</code><code class="sig-prename descclassname"> &lt;sort_col&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-image-umap-embeddings-sc" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort samples on this column.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-image-umap-embeddings-sm">
<code class="sig-name descname">-sm</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--sort_mode</code><code class="sig-prename descclassname"> &lt;sort_mode&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-image-umap-embeddings-sm" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort ascending or descending.  [default: asc]</p>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>asc|desc</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="pathflowai-visualize-plot-mask-mpl">
<h3>plot-mask-mpl<a class="headerlink" href="#pathflowai-visualize-plot-mask-mpl" title="Permalink to this headline">¶</a></h3>
<p>Plots the whole slide mask supplied.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-visualize plot-mask-mpl <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-mask-mpl-i">
<code class="sig-name descname">-i</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--mask_file</code><code class="sig-prename descclassname"> &lt;mask_file&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-mask-mpl-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Input mask file.  [default: ./inputs/a_mask.npy]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-mask-mpl-o">
<code class="sig-name descname">-o</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--outputfname</code><code class="sig-prename descclassname"> &lt;outputfname&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-mask-mpl-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Output extracted image.  [default: ./output_image.png]</p>
</dd></dl>

</div>
<div class="section" id="pathflowai-visualize-plot-predictions">
<h3>plot-predictions<a class="headerlink" href="#pathflowai-visualize-plot-predictions" title="Permalink to this headline">¶</a></h3>
<p>Overlays classification, regression and segmentation patch level predictions on top of whole slide image.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-visualize plot-predictions <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-predictions-i">
<code class="sig-name descname">-i</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--input_dir</code><code class="sig-prename descclassname"> &lt;input_dir&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-predictions-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Input directory for patches.  [default: ./inputs/]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-predictions-b">
<code class="sig-name descname">-b</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--basename</code><code class="sig-prename descclassname"> &lt;basename&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-predictions-b" title="Permalink to this definition">¶</a></dt>
<dd><p>Basename of patches.  [default: A01]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-predictions-p">
<code class="sig-name descname">-p</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--patch_info_file</code><code class="sig-prename descclassname"> &lt;patch_info_file&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-predictions-p" title="Permalink to this definition">¶</a></dt>
<dd><p>Datbase containing all patches  [default: patch_info.db]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-predictions-ps">
<code class="sig-name descname">-ps</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--patch_size</code><code class="sig-prename descclassname"> &lt;patch_size&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-predictions-ps" title="Permalink to this definition">¶</a></dt>
<dd><p>Patch size.  [default: 224]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-predictions-o">
<code class="sig-name descname">-o</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--outputfname</code><code class="sig-prename descclassname"> &lt;outputfname&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-predictions-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Output extracted image.  [default: ./output_image.png]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-predictions-an">
<code class="sig-name descname">-an</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--annotations</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-predictions-an" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot annotations instead of predictions.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-predictions-cf">
<code class="sig-name descname">-cf</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--compression_factor</code><code class="sig-prename descclassname"> &lt;compression_factor&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-predictions-cf" title="Permalink to this definition">¶</a></dt>
<dd><p>How much compress image.  [default: 3.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-predictions-al">
<code class="sig-name descname">-al</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--alpha</code><code class="sig-prename descclassname"> &lt;alpha&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-predictions-al" title="Permalink to this definition">¶</a></dt>
<dd><p>How much to give annotations/predictions versus original image.  [default: 0.8]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-predictions-s">
<code class="sig-name descname">-s</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--segmentation</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-predictions-s" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot segmentations.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-predictions-sc">
<code class="sig-name descname">-sc</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--n_segmentation_classes</code><code class="sig-prename descclassname"> &lt;n_segmentation_classes&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-predictions-sc" title="Permalink to this definition">¶</a></dt>
<dd><p>Number segmentation classes  [default: 4]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-predictions-c">
<code class="sig-name descname">-c</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--custom_segmentation</code><code class="sig-prename descclassname"> &lt;custom_segmentation&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-predictions-c" title="Permalink to this definition">¶</a></dt>
<dd><p>Add custom segmentation map from prediction, npy format.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-predictions-ac">
<code class="sig-name descname">-ac</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--annotation_col</code><code class="sig-prename descclassname"> &lt;annotation_col&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-predictions-ac" title="Permalink to this definition">¶</a></dt>
<dd><p>Column of annotations  [default: annotation]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-predictions-sf">
<code class="sig-name descname">-sf</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--scaling_factor</code><code class="sig-prename descclassname"> &lt;scaling_factor&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-predictions-sf" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply all prediction scores by this amount.  [default: 1.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-plot-predictions-tif">
<code class="sig-name descname">-tif</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--tif_file</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-visualize-plot-predictions-tif" title="Permalink to this definition">¶</a></dt>
<dd><p>Write to tiff file.  [default: False]</p>
</dd></dl>

</div>
<div class="section" id="pathflowai-visualize-shapley-plot">
<h3>shapley-plot<a class="headerlink" href="#pathflowai-visualize-shapley-plot" title="Permalink to this headline">¶</a></h3>
<p>Run SHAPley attribution method on patches after classification task.</p>
<p>This is to see what the model made prediction based on.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-visualize shapley-plot <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-visualize-shapley-plot-m">
<code class="sig-name descname">-m</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--model_pkl</code><code class="sig-prename descclassname"> &lt;model_pkl&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-shapley-plot-m" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotly output file.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-shapley-plot-bs">
<code class="sig-name descname">-bs</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--batch_size</code><code class="sig-prename descclassname"> &lt;batch_size&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-shapley-plot-bs" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch size.  [default: 32]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-shapley-plot-o">
<code class="sig-name descname">-o</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--outputfilename</code><code class="sig-prename descclassname"> &lt;outputfilename&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-shapley-plot-o" title="Permalink to this definition">¶</a></dt>
<dd><p>SHAPley visualization.  [default: predictions/shap_plots.png]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-shapley-plot-mth">
<code class="sig-name descname">-mth</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--method</code><code class="sig-prename descclassname"> &lt;method&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-shapley-plot-mth" title="Permalink to this definition">¶</a></dt>
<dd><p>Method of explaining.  [default: deep]</p>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>deep|gradient</p>
</dd>
</dl>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-shapley-plot-l">
<code class="sig-name descname">-l</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--local_smoothing</code><code class="sig-prename descclassname"> &lt;local_smoothing&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-shapley-plot-l" title="Permalink to this definition">¶</a></dt>
<dd><p>Local smoothing of SHAP scores.  [default: 0.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-shapley-plot-ns">
<code class="sig-name descname">-ns</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--n_samples</code><code class="sig-prename descclassname"> &lt;n_samples&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-shapley-plot-ns" title="Permalink to this definition">¶</a></dt>
<dd><p>Number shapley samples for shapley regression (gradient explainer).  [default: 32]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-visualize-shapley-plot-p">
<code class="sig-name descname">-p</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--pred_out</code><code class="sig-prename descclassname"> &lt;pred_out&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-visualize-shapley-plot-p" title="Permalink to this definition">¶</a></dt>
<dd><p>If not none, output prediction as shap label.  [default: none]</p>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>none|sigmoid|softmax</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="pathflowai-train-model">
<h2>pathflowai-train_model<a class="headerlink" href="#pathflowai-train-model" title="Permalink to this headline">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-train_model <span class="o">[</span>OPTIONS<span class="o">]</span> COMMAND <span class="o">[</span>ARGS<span class="o">]</span>...
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-train-model-version">
<code class="sig-name descname">--version</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-version" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the version and exit.</p>
</dd></dl>

<div class="section" id="pathflowai-train-model-train-model">
<h3>train-model<a class="headerlink" href="#pathflowai-train-model-train-model" title="Permalink to this headline">¶</a></h3>
<p>Train and predict using model for regression and classification tasks.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-train_model train-model <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-s">
<code class="sig-name descname">-s</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--segmentation</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-s" title="Permalink to this definition">¶</a></dt>
<dd><p>Segmentation task.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-p">
<code class="sig-name descname">-p</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--prediction</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-p" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict on model.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-pa">
<code class="sig-name descname">-pa</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--pos_annotation_class</code><code class="sig-prename descclassname"> &lt;pos_annotation_class&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-pa" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotation Class from which to apply positive labels.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-oa">
<code class="sig-name descname">-oa</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--other_annotations</code><code class="sig-prename descclassname"> &lt;other_annotations&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-oa" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotations in image.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-o">
<code class="sig-name descname">-o</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--save_location</code><code class="sig-prename descclassname"> &lt;save_location&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-o" title="Permalink to this definition">¶</a></dt>
<dd><p>Model Save Location, append with pickle .pkl.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-pt">
<code class="sig-name descname">-pt</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--pretrained_save_location</code><code class="sig-prename descclassname"> &lt;pretrained_save_location&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Model Save Location, append with pickle .pkl, pretrained by previous analysis to be finetuned.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-i">
<code class="sig-name descname">-i</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--input_dir</code><code class="sig-prename descclassname"> &lt;input_dir&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Input directory containing slides and everything.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-ps">
<code class="sig-name descname">-ps</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--patch_size</code><code class="sig-prename descclassname"> &lt;patch_size&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-ps" title="Permalink to this definition">¶</a></dt>
<dd><p>Patch size.  [default: 224]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-pr">
<code class="sig-name descname">-pr</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--patch_resize</code><code class="sig-prename descclassname"> &lt;patch_resize&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-pr" title="Permalink to this definition">¶</a></dt>
<dd><p>Patch resized.  [default: 224]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-tg">
<code class="sig-name descname">-tg</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--target_names</code><code class="sig-prename descclassname"> &lt;target_names&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-tg" title="Permalink to this definition">¶</a></dt>
<dd><p>Targets.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-df">
<code class="sig-name descname">-df</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--dataset_df</code><code class="sig-prename descclassname"> &lt;dataset_df&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-df" title="Permalink to this definition">¶</a></dt>
<dd><p>CSV file with train/val/test and target info.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-fn">
<code class="sig-name descname">-fn</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--fix_names</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to fix names in dataset_df.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-a">
<code class="sig-name descname">-a</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--architecture</code><code class="sig-prename descclassname"> &lt;architecture&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-a" title="Permalink to this definition">¶</a></dt>
<dd><p>Neural Network Architecture.  [default: alexnet]</p>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>alexnet|densenet121|densenet161|densenet169|densenet201|inception_v3|resnet101|resnet152|resnet18|resnet34|resnet50|vgg11|vgg11_bn|unet|unet2|nested_unet|fast_scnn|vgg13|vgg13_bn|vgg16|vgg16_bn|vgg19|vgg19_bn|deeplabv3_resnet101|deeplabv3_resnet50|fcn_resnet101|fcn_resnet50|sqnxt23_w3d2|sqnxt23_w2|sqnxt23v5_w1|sqnxt23v5_w3d2|sqnxt23v5_w2|efficientnet-b0|efficientnet-b1|efficientnet-b2|efficientnet-b3|efficientnet-b4|efficientnet-b5|efficientnet-b6|efficientnet-b7</p>
</dd>
</dl>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-imb">
<code class="sig-name descname">-imb</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--imbalanced_correction</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-imb" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to correct for imbalanced data.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-imb2">
<code class="sig-name descname">-imb2</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--imbalanced_correction2</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-imb2" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to correct for imbalanced data.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-ca">
<code class="sig-name descname">-ca</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--classify_annotations</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-ca" title="Permalink to this definition">¶</a></dt>
<dd><p>Classify annotations.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-nt">
<code class="sig-name descname">-nt</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--num_targets</code><code class="sig-prename descclassname"> &lt;num_targets&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-nt" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of targets.  [default: 1]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-ss">
<code class="sig-name descname">-ss</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--subsample_p</code><code class="sig-prename descclassname"> &lt;subsample_p&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-ss" title="Permalink to this definition">¶</a></dt>
<dd><p>Subsample training set.  [default: 1.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-ssv">
<code class="sig-name descname">-ssv</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--subsample_p_val</code><code class="sig-prename descclassname"> &lt;subsample_p_val&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-ssv" title="Permalink to this definition">¶</a></dt>
<dd><p>Subsample val set. If not set, defaults to that of training set  [default: -1.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-t">
<code class="sig-name descname">-t</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--num_training_images_epoch</code><code class="sig-prename descclassname"> &lt;num_training_images_epoch&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-t" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of training images per epoch. -1 means use all training images each epoch.  [default: -1]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-lr">
<code class="sig-name descname">-lr</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--learning_rate</code><code class="sig-prename descclassname"> &lt;learning_rate&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-lr" title="Permalink to this definition">¶</a></dt>
<dd><p>Learning rate.  [default: 0.01]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-tp">
<code class="sig-name descname">-tp</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--transform_platform</code><code class="sig-prename descclassname"> &lt;transform_platform&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-tp" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform platform for nonsegmentation tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>torch|albumentations</p>
</dd>
</dl>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-ne">
<code class="sig-name descname">-ne</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--n_epoch</code><code class="sig-prename descclassname"> &lt;n_epoch&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-ne" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of epochs.  [default: 10]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-pi">
<code class="sig-name descname">-pi</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--patch_info_file</code><code class="sig-prename descclassname"> &lt;patch_info_file&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-pi" title="Permalink to this definition">¶</a></dt>
<dd><p>Patch info file.  [default: patch_info.db]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-tc">
<code class="sig-name descname">-tc</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--target_segmentation_class</code><code class="sig-prename descclassname"> &lt;target_segmentation_class&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-tc" title="Permalink to this definition">¶</a></dt>
<dd><p>Segmentation Class to finetune on.  [default: -1]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-tt">
<code class="sig-name descname">-tt</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--target_threshold</code><code class="sig-prename descclassname"> &lt;target_threshold&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-tt" title="Permalink to this definition">¶</a></dt>
<dd><p>Threshold to include target for segmentation if saving one class.  [default: 0.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-ov">
<code class="sig-name descname">-ov</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--oversampling_factor</code><code class="sig-prename descclassname"> &lt;oversampling_factor&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-ov" title="Permalink to this definition">¶</a></dt>
<dd><p>How much to oversample training set.  [default: 1.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-sup">
<code class="sig-name descname">-sup</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--supplement</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-sup" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the thresholding to supplement the original training set.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-bs">
<code class="sig-name descname">-bs</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--batch_size</code><code class="sig-prename descclassname"> &lt;batch_size&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-bs" title="Permalink to this definition">¶</a></dt>
<dd><p>Batch size.  [default: 10]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-rt">
<code class="sig-name descname">-rt</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--run_test</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-rt" title="Permalink to this definition">¶</a></dt>
<dd><p>Output predictions for a batch to “test_predictions.npy”. Use for debugging.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-mtb">
<code class="sig-name descname">-mtb</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--mt_bce</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-mtb" title="Permalink to this definition">¶</a></dt>
<dd><p>Run multi-target bce predictions on the annotations.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-po">
<code class="sig-name descname">-po</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--prediction_output_dir</code><code class="sig-prename descclassname"> &lt;prediction_output_dir&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-po" title="Permalink to this definition">¶</a></dt>
<dd><p>Where to output segmentation predictions.  [default: predictions]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-ee">
<code class="sig-name descname">-ee</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--extract_embedding</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-ee" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract embeddings.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-em">
<code class="sig-name descname">-em</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--extract_model</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-em" title="Permalink to this definition">¶</a></dt>
<dd><p>Save entire torch model.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-bt">
<code class="sig-name descname">-bt</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--binary_threshold</code><code class="sig-prename descclassname"> &lt;binary_threshold&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-bt" title="Permalink to this definition">¶</a></dt>
<dd><p>If running binary classification on annotations, dichotomize selected annotation as such.  [default: 0.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-prt">
<code class="sig-name descname">-prt</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--pretrain</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-prt" title="Permalink to this definition">¶</a></dt>
<dd><p>Pretrain on ImageNet.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-olf">
<code class="sig-name descname">-olf</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--overwrite_loss_fn</code><code class="sig-prename descclassname"> &lt;overwrite_loss_fn&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-olf" title="Permalink to this definition">¶</a></dt>
<dd><p>Overwrite the default training loss functions with loss of choice.  [default: ]</p>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><a href="#id1"><span class="problematic" id="id2">|</span></a>bce|mse|focal|dice|gdl|ce</p>
</dd>
</dl>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-atl">
<code class="sig-name descname">-atl</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--adopt_training_loss</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-atl" title="Permalink to this definition">¶</a></dt>
<dd><p>Adopt training loss function for validation calculation.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-tdb">
<code class="sig-name descname">-tdb</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--external_test_db</code><code class="sig-prename descclassname"> &lt;external_test_db&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-tdb" title="Permalink to this definition">¶</a></dt>
<dd><p>External database of samples to test on.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-tdir">
<code class="sig-name descname">-tdir</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--external_test_dir</code><code class="sig-prename descclassname"> &lt;external_test_dir&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-tdir" title="Permalink to this definition">¶</a></dt>
<dd><p>External directory of samples to test on.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-pb">
<code class="sig-name descname">-pb</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--prediction_basename</code><code class="sig-prename descclassname"> &lt;prediction_basename&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-pb" title="Permalink to this definition">¶</a></dt>
<dd><p>For segmentation tasks, if supplied, can predict on these basenames rather than the entire test set. Only works for segmentation tasks for now  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-cw">
<code class="sig-name descname">-cw</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--custom_weights</code><code class="sig-prename descclassname"> &lt;custom_weights&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-cw" title="Permalink to this definition">¶</a></dt>
<dd><p>Comma delimited custom weights  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-pset">
<code class="sig-name descname">-pset</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--prediction_set</code><code class="sig-prename descclassname"> &lt;prediction_set&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-pset" title="Permalink to this definition">¶</a></dt>
<dd><p>Dataset to predict on.  [default: test]</p>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>train|val|test</p>
</dd>
</dl>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-ut">
<code class="sig-name descname">-ut</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--user_transforms_file</code><code class="sig-prename descclassname"> &lt;user_transforms_file&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-ut" title="Permalink to this definition">¶</a></dt>
<dd><p>YAML file to add transforms from.  [default: ]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-svp">
<code class="sig-name descname">-svp</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--save_val_predictions</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-svp" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether to save the validation predictions.  [default: False]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-soc">
<code class="sig-name descname">-soc</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--seg_out_class</code><code class="sig-prename descclassname"> &lt;seg_out_class&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-soc" title="Permalink to this definition">¶</a></dt>
<dd><p>Output a particular segmentation class probabilities.  [default: -1]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-train-model-train-model-aol">
<code class="sig-name descname">-aol</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--apex_opt_level</code><code class="sig-prename descclassname"> &lt;apex_opt_level&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-train-model-train-model-aol" title="Permalink to this definition">¶</a></dt>
<dd><p>YAML file to add transforms from.  [default: O2]</p>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>O0|O1|O2|O3</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="pathflowai-monitor">
<h2>pathflowai-monitor<a class="headerlink" href="#pathflowai-monitor" title="Permalink to this headline">¶</a></h2>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-monitor <span class="o">[</span>OPTIONS<span class="o">]</span> COMMAND <span class="o">[</span>ARGS<span class="o">]</span>...
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-monitor-version">
<code class="sig-name descname">--version</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-pathflowai-monitor-version" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the version and exit.</p>
</dd></dl>

<div class="section" id="pathflowai-monitor-monitor-usage">
<h3>monitor-usage<a class="headerlink" href="#pathflowai-monitor-monitor-usage" title="Permalink to this headline">¶</a></h3>
<p>Monitor Usage over Time Interval.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pathflowai-monitor monitor-usage <span class="o">[</span>OPTIONS<span class="o">]</span>
</pre></div>
</div>
<p class="rubric">Options</p>
<dl class="option">
<dt id="cmdoption-pathflowai-monitor-monitor-usage-csv">
<code class="sig-name descname">-csv</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--records_output_csv</code><code class="sig-prename descclassname"> &lt;records_output_csv&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-monitor-monitor-usage-csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Where to store records.  [default: records.csv]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-monitor-monitor-usage-tt">
<code class="sig-name descname">-tt</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--total_time</code><code class="sig-prename descclassname"> &lt;total_time&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-monitor-monitor-usage-tt" title="Permalink to this definition">¶</a></dt>
<dd><p>Total time to monitor for in minutes.  [default: 1.0]</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-pathflowai-monitor-monitor-usage-dt">
<code class="sig-name descname">-dt</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--delay_time</code><code class="sig-prename descclassname"> &lt;delay_time&gt;</code><a class="headerlink" href="#cmdoption-pathflowai-monitor-monitor-usage-dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Time between samples, in seconds.  [default: 1.0]</p>
</dd></dl>

</div>
</div>
<span class="target" id="module-pathflowai.datasets"></span><div class="section" id="datasets-py">
<h2>datasets.py<a class="headerlink" href="#datasets-py" title="Permalink to this headline">¶</a></h2>
<p>Houses the DynamicImageDataset class, also functions to help with image color channel normalization, transformers, etc..</p>
<dl class="class">
<dt id="pathflowai.datasets.DynamicImageDataset">
<em class="property">class </em><code class="sig-prename descclassname">pathflowai.datasets.</code><code class="sig-name descname">DynamicImageDataset</code><span class="sig-paren">(</span><em class="sig-param">dataset_df</em>, <em class="sig-param">set</em>, <em class="sig-param">patch_info_file</em>, <em class="sig-param">transformers</em>, <em class="sig-param">input_dir</em>, <em class="sig-param">target_names</em>, <em class="sig-param">pos_annotation_class</em>, <em class="sig-param">other_annotations=[]</em>, <em class="sig-param">segmentation=False</em>, <em class="sig-param">patch_size=224</em>, <em class="sig-param">fix_names=True</em>, <em class="sig-param">target_segmentation_class=-1</em>, <em class="sig-param">target_threshold=0.0</em>, <em class="sig-param">oversampling_factor=1.0</em>, <em class="sig-param">n_segmentation_classes=4</em>, <em class="sig-param">gdl=False</em>, <em class="sig-param">mt_bce=False</em>, <em class="sig-param">classify_annotations=False</em>, <em class="sig-param">dilation_jitter={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/datasets.html#DynamicImageDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.datasets.DynamicImageDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate image dataset that accesses images and annotations via dask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_df</strong> (<em>dataframe</em>) – Dataframe with WSI, which set it is in (train/test/val) and corresponding WSI labels if applicable.</p></li>
<li><p><strong>set</strong> (<em>str</em>) – Whether train, test, val or pass (normalization) set.</p></li>
<li><p><strong>patch_info_file</strong> (<em>str</em>) – SQL db with positional and annotation information on each slide.</p></li>
<li><p><strong>transformers</strong> (<em>dict</em>) – Contains transformers to apply on images.</p></li>
<li><p><strong>input_dir</strong> (<em>str</em>) – Directory where images comes from.</p></li>
<li><p><strong>target_names</strong> (<em>list/str</em>) – Names of initial targets, which may be modified.</p></li>
<li><p><strong>pos_annotation_class</strong> (<em>str</em>) – If selected and predicting on WSI, this class is labeled as a positive from the WSI, while the other classes are not.</p></li>
<li><p><strong>other_annotations</strong> (<em>list</em>) – Other annotations to consider from patch info db.</p></li>
<li><p><strong>segmentation</strong> (<em>bool</em>) – Conducting segmentation task?</p></li>
<li><p><strong>patch_size</strong> (<em>int</em>) – Patch size.</p></li>
<li><p><strong>fix_names</strong> (<em>bool</em>) – Whether to change the names of dataset_df.</p></li>
<li><p><strong>target_segmentation_class</strong> (<em>list</em>) – Now can be used for classification as well, matched with two below options, samples images only from this class. Can specify this and below two options multiple times.</p></li>
<li><p><strong>target_threshold</strong> (<em>list</em>) – Sampled only if above this threshold of occurence in the patches.</p></li>
<li><p><strong>oversampling_factor</strong> (<em>list</em>) – Over sample them at this amount.</p></li>
<li><p><strong>n_segmentation_classes</strong> (<em>int</em>) – Number classes to segment.</p></li>
<li><p><strong>gdl</strong> (<em>bool</em>) – Using generalized dice loss?</p></li>
<li><p><strong>mt_bce</strong> (<em>bool</em>) – For multi-target prediction tasks.</p></li>
<li><p><strong>classify_annotations</strong> (<em>bool</em>) – For classifying annotations.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pathflowai.datasets.DynamicImageDataset.binarize_annotations">
<code class="sig-name descname">binarize_annotations</code><span class="sig-paren">(</span><em class="sig-param">binarizer=None</em>, <em class="sig-param">num_targets=1</em>, <em class="sig-param">binary_threshold=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/datasets.html#DynamicImageDataset.binarize_annotations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.datasets.DynamicImageDataset.binarize_annotations" title="Permalink to this definition">¶</a></dt>
<dd><p>Label binarize some annotations or threshold them if classifying slide annotations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>binarizer</strong> (<em>LabelBinarizer</em>) – Binarizes the labels of a column(s)</p></li>
<li><p><strong>num_targets</strong> (<em>int</em>) – Number of desired targets to preidict on.</p></li>
<li><p><strong>binary_threshold</strong> (<em>float</em>) – Amount of annotation in patch before positive annotation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>binarizer</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.datasets.DynamicImageDataset.concat">
<code class="sig-name descname">concat</code><span class="sig-paren">(</span><em class="sig-param">other_dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/datasets.html#DynamicImageDataset.concat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.datasets.DynamicImageDataset.concat" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate this dataset with others. Updates its own internal attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other_dataset</strong> (<a class="reference internal" href="#pathflowai.datasets.DynamicImageDataset" title="pathflowai.datasets.DynamicImageDataset"><em>DynamicImageDataset</em></a>) – Other image dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.datasets.DynamicImageDataset.get_class_weights">
<code class="sig-name descname">get_class_weights</code><span class="sig-paren">(</span><em class="sig-param">i=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/datasets.html#DynamicImageDataset.get_class_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.datasets.DynamicImageDataset.get_class_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Weight loss function with weights inversely proportional to the class appearence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> (<em>int</em>) – If multi-target, class used for weighting.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataset.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.datasets.DynamicImageDataset.retain_ID">
<code class="sig-name descname">retain_ID</code><span class="sig-paren">(</span><em class="sig-param">ID</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/datasets.html#DynamicImageDataset.retain_ID"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.datasets.DynamicImageDataset.retain_ID" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce the sample set to just images from one ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ID</strong> (<em>str</em>) – Basename/ID to predict on.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.datasets.DynamicImageDataset.split_by_ID">
<code class="sig-name descname">split_by_ID</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/datasets.html#DynamicImageDataset.split_by_ID"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.datasets.DynamicImageDataset.split_by_ID" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator similar to groupby, but splits up by ID, generates (ID,data) using retain_ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>ID, DynamicDataset</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>generator</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.datasets.DynamicImageDataset.subsample">
<code class="sig-name descname">subsample</code><span class="sig-paren">(</span><em class="sig-param">p</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/datasets.html#DynamicImageDataset.subsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.datasets.DynamicImageDataset.subsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample subset of dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>p</strong> (<em>float</em>) – Fraction to subsample.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.datasets.DynamicImageDataset.update_dataset">
<code class="sig-name descname">update_dataset</code><span class="sig-paren">(</span><em class="sig-param">input_dir</em>, <em class="sig-param">new_db</em>, <em class="sig-param">prediction_basename=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/datasets.html#DynamicImageDataset.update_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.datasets.DynamicImageDataset.update_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Experimental. Only use for segmentation for now.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pathflowai.datasets.RandomRotate90">
<code class="sig-prename descclassname">pathflowai.datasets.</code><code class="sig-name descname">RandomRotate90</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/datasets.html#RandomRotate90"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.datasets.RandomRotate90" title="Permalink to this definition">¶</a></dt>
<dd><p>Transformer for random 90 degree rotation image.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Transformer function for operation.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.datasets.create_transforms">
<code class="sig-prename descclassname">pathflowai.datasets.</code><code class="sig-name descname">create_transforms</code><span class="sig-paren">(</span><em class="sig-param">mean</em>, <em class="sig-param">std</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/datasets.html#create_transforms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.datasets.create_transforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Create transformers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<em>list</em>) – See get_data_transforms.</p></li>
<li><p><strong>std</strong> (<em>list</em>) – See get_data_transforms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Transformers.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.datasets.get_data_transforms">
<code class="sig-prename descclassname">pathflowai.datasets.</code><code class="sig-name descname">get_data_transforms</code><span class="sig-paren">(</span><em class="sig-param">patch_size=None</em>, <em class="sig-param">mean=[]</em>, <em class="sig-param">std=[]</em>, <em class="sig-param">resize=False</em>, <em class="sig-param">transform_platform='torch'</em>, <em class="sig-param">elastic=True</em>, <em class="sig-param">user_transforms={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/datasets.html#get_data_transforms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.datasets.get_data_transforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Get data transformers for training test and validation sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patch_size</strong> (<em>int</em>) – Original patch size being transformed.</p></li>
<li><p><strong>mean</strong> (<em>list of float</em>) – Mean RGB</p></li>
<li><p><strong>std</strong> (<em>list of float</em>) – Std RGB</p></li>
<li><p><strong>resize</strong> (<em>int</em>) – Which patch size to resize to.</p></li>
<li><p><strong>transform_platform</strong> (<em>str</em>) – Use pytorch or albumentation transforms.</p></li>
<li><p><strong>elastic</strong> (<em>bool</em>) – Whether to add elastic deformations from albumentations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Transformers.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.datasets.get_normalizer">
<code class="sig-prename descclassname">pathflowai.datasets.</code><code class="sig-name descname">get_normalizer</code><span class="sig-paren">(</span><em class="sig-param">normalization_file</em>, <em class="sig-param">dataset_opts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/datasets.html#get_normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.datasets.get_normalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Find mean and standard deviation of images in batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalization_file</strong> (<em>str</em>) – File to store normalization information.</p></li>
<li><p><strong>dataset_opts</strong> (<em>type</em>) – Dictionary storing information to create DynamicDataset class.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Stores RGB mean, stdev.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.datasets.segmentation_transform">
<code class="sig-prename descclassname">pathflowai.datasets.</code><code class="sig-name descname">segmentation_transform</code><span class="sig-paren">(</span><em class="sig-param">img</em>, <em class="sig-param">mask</em>, <em class="sig-param">transformer</em>, <em class="sig-param">normalizer</em>, <em class="sig-param">alb_reduction</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/datasets.html#segmentation_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.datasets.segmentation_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Run albumentations and return an image and its segmentation mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>array</em>) – Image as array</p></li>
<li><p><strong>mask</strong> (<em>array</em>) – Categorical pixel by pixel.</p></li>
<li><p><strong>transformer</strong> – Transformation object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Image and mask array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple arrays</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-pathflowai.losses"></span><div class="section" id="losses-py">
<h2>losses.py<a class="headerlink" href="#losses-py" title="Permalink to this headline">¶</a></h2>
<p>Some additional loss functions that can be called using the pipeline, some of which still to be implemented.</p>
<dl class="class">
<dt id="pathflowai.losses.FocalLoss">
<em class="property">class </em><code class="sig-prename descclassname">pathflowai.losses.</code><code class="sig-name descname">FocalLoss</code><span class="sig-paren">(</span><em class="sig-param">num_class</em>, <em class="sig-param">alpha=None</em>, <em class="sig-param">gamma=2</em>, <em class="sig-param">balance_index=-1</em>, <em class="sig-param">smooth=None</em>, <em class="sig-param">size_average=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/losses.html#FocalLoss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.FocalLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Focal Loss, as proposed in <a href="#id7"><span class="problematic" id="id3">[1]_</span></a>.</p>
<dl class="attribute">
<dt id="pathflowai.losses.FocalLoss.num_class">
<code class="sig-name descname">num_class</code><a class="headerlink" href="#pathflowai.losses.FocalLoss.num_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Binarizes the labels of a column(s).</p>
</dd></dl>

<dl class="attribute">
<dt id="pathflowai.losses.FocalLoss.alpha">
<code class="sig-name descname">alpha</code><a class="headerlink" href="#pathflowai.losses.FocalLoss.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of desired targets to preidict on.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pathflowai.losses.FocalLoss.gamma">
<code class="sig-name descname">gamma</code><a class="headerlink" href="#pathflowai.losses.FocalLoss.gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>When gamma is nonnegative, the relative loss for well-classified examples (p&gt;0.5) is reduced, putting more focus on hard misclassified examples.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float or double</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pathflowai.losses.FocalLoss.smooth">
<code class="sig-name descname">smooth</code><a class="headerlink" href="#pathflowai.losses.FocalLoss.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Smooth value to use when computing cross entropy.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float or double</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pathflowai.losses.FocalLoss.balance_index">
<code class="sig-name descname">balance_index</code><a class="headerlink" href="#pathflowai.losses.FocalLoss.balance_index" title="Permalink to this definition">¶</a></dt>
<dd><p>The balance class index, should be specific when alpha is a float.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pathflowai.losses.FocalLoss.size_average">
<code class="sig-name descname">size_average</code><a class="headerlink" href="#pathflowai.losses.FocalLoss.size_average" title="Permalink to this definition">¶</a></dt>
<dd><p>By default, the losses are averaged over each loss element in the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool, optional</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Notes</p>
<div class="math notranslate nohighlight">
\[FL(p_t)=-lpha_t(1-p_t)^\gamma\log(p_t)\]</div>
<p><a class="reference external" href="https://raw.githubusercontent.com/Hsuxu/Loss_ToolBox-PyTorch/master/FocalLoss/focal_loss.py">https://raw.githubusercontent.com/Hsuxu/Loss_ToolBox-PyTorch/master/FocalLoss/focal_loss.py</a>.</p>
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets">1</span></dt>
<dd><p>Lin, Tsung-Yi, et al. “Focal Loss for Dense Object Detection.”
ArXiv:1708.02002 [Cs], Feb. 2018. arXiv.org,
http://arxiv.org/abs/1708.02002.</p>
</dd>
</dl>
<dl class="method">
<dt id="pathflowai.losses.FocalLoss.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">logit</em>, <em class="sig-param">target</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/losses.html#FocalLoss.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.FocalLoss.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pathflowai.losses.GeneralizedDice">
<em class="property">class </em><code class="sig-prename descclassname">pathflowai.losses.</code><code class="sig-name descname">GeneralizedDice</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/losses.html#GeneralizedDice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.GeneralizedDice" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/losses.py">https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/losses.py</a></p>
</dd></dl>

<dl class="class">
<dt id="pathflowai.losses.GeneralizedDiceLoss">
<em class="property">class </em><code class="sig-prename descclassname">pathflowai.losses.</code><code class="sig-name descname">GeneralizedDiceLoss</code><span class="sig-paren">(</span><em class="sig-param">weight=None</em>, <em class="sig-param">channelwise=False</em>, <em class="sig-param">eps=1e-06</em>, <em class="sig-param">add_softmax=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/losses.html#GeneralizedDiceLoss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.GeneralizedDiceLoss" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://raw.githubusercontent.com/inferno-pytorch/inferno/0561e8a95cde6bfc5e10a3609841b7b0ca5b03ca/inferno/extensions/criteria/set_similarity_measures.py">https://raw.githubusercontent.com/inferno-pytorch/inferno/0561e8a95cde6bfc5e10a3609841b7b0ca5b03ca/inferno/extensions/criteria/set_similarity_measures.py</a>
Computes the scalar Generalized Dice Loss defined in <a class="reference external" href="https://arxiv.org/abs/1707.03237">https://arxiv.org/abs/1707.03237</a></p>
<p>This version works for multiple classes and expects predictions for every class (e.g. softmax output) and
one-hot targets for every class.</p>
<dl class="method">
<dt id="pathflowai.losses.GeneralizedDiceLoss.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">input</em>, <em class="sig-param">target</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/losses.html#GeneralizedDiceLoss.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.GeneralizedDiceLoss.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>input: torch.FloatTensor or torch.cuda.FloatTensor
target:     torch.FloatTensor or torch.cuda.FloatTensor</p>
<dl class="simple">
<dt>Expected shape of the inputs:</dt><dd><ul class="simple">
<li><p>if not channelwise: (batch_size, nb_classes, …)</p></li>
<li><p>if channelwise:     (batch_size, nb_channels, nb_classes, …)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="pathflowai.losses.ShapeError">
<em class="property">exception </em><code class="sig-prename descclassname">pathflowai.losses.</code><code class="sig-name descname">ShapeError</code><a class="reference internal" href="_modules/pathflowai/losses.html#ShapeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.ShapeError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="pathflowai.losses.SurfaceLoss">
<em class="property">class </em><code class="sig-prename descclassname">pathflowai.losses.</code><code class="sig-name descname">SurfaceLoss</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/losses.html#SurfaceLoss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.SurfaceLoss" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/losses.py">https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/losses.py</a></p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.losses.assert_">
<code class="sig-prename descclassname">pathflowai.losses.</code><code class="sig-name descname">assert_</code><span class="sig-paren">(</span><em class="sig-param">condition</em>, <em class="sig-param">message=''</em>, <em class="sig-param">exception_type=&lt;class 'AssertionError'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/losses.html#assert_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.assert_" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://raw.githubusercontent.com/inferno-pytorch/inferno/0561e8a95cde6bfc5e10a3609841b7b0ca5b03ca/inferno/utils/exceptions.py">https://raw.githubusercontent.com/inferno-pytorch/inferno/0561e8a95cde6bfc5e10a3609841b7b0ca5b03ca/inferno/utils/exceptions.py</a>
Like assert, but with arbitrary exception types.</p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.losses.class2one_hot">
<code class="sig-prename descclassname">pathflowai.losses.</code><code class="sig-name descname">class2one_hot</code><span class="sig-paren">(</span><em class="sig-param">seg: torch.Tensor</em>, <em class="sig-param">C: int</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pathflowai/losses.html#class2one_hot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.class2one_hot" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/utils.py">https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/utils.py</a></p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.losses.eq">
<code class="sig-prename descclassname">pathflowai.losses.</code><code class="sig-name descname">eq</code><span class="sig-paren">(</span><em class="sig-param">a: torch.Tensor</em>, <em class="sig-param">b</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pathflowai/losses.html#eq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.eq" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/utils.py">https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/utils.py</a></p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.losses.flatten_samples">
<code class="sig-prename descclassname">pathflowai.losses.</code><code class="sig-name descname">flatten_samples</code><span class="sig-paren">(</span><em class="sig-param">input_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/losses.html#flatten_samples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.flatten_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Flattens a tensor or a variable.</p>
<p>Flattens a tensor or variable such that the channel axis is first and the
sample axis is second. The shapes are transformed as follows:
(N, C, H, W) –&gt; (C, N * H * W)
(N, C, D, H, W) –&gt; (C, N * D * H * W)
(N, C) –&gt; (C, N)</p>
<p>The input must be at least 2-D.</p>
<p class="rubric">Notes</p>
<p><a class="reference external" href="https://raw.githubusercontent.com/inferno-pytorch/inferno/0561e8a95cde6bfc5e10a3609841b7b0ca5b03ca/inferno/utils/torch_utils.py">https://raw.githubusercontent.com/inferno-pytorch/inferno/0561e8a95cde6bfc5e10a3609841b7b0ca5b03ca/inferno/utils/torch_utils.py</a></p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.losses.one_hot">
<code class="sig-prename descclassname">pathflowai.losses.</code><code class="sig-name descname">one_hot</code><span class="sig-paren">(</span><em class="sig-param">t: torch.Tensor</em>, <em class="sig-param">axis=1</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pathflowai/losses.html#one_hot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.one_hot" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/utils.py">https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/utils.py</a></p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.losses.one_hot2dist">
<code class="sig-prename descclassname">pathflowai.losses.</code><code class="sig-name descname">one_hot2dist</code><span class="sig-paren">(</span><em class="sig-param">seg: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/pathflowai/losses.html#one_hot2dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.one_hot2dist" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/utils.py">https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/utils.py</a></p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.losses.simplex">
<code class="sig-prename descclassname">pathflowai.losses.</code><code class="sig-name descname">simplex</code><span class="sig-paren">(</span><em class="sig-param">t: torch.Tensor</em>, <em class="sig-param">axis=1</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pathflowai/losses.html#simplex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.simplex" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/utils.py">https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/utils.py</a></p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.losses.sset">
<code class="sig-prename descclassname">pathflowai.losses.</code><code class="sig-name descname">sset</code><span class="sig-paren">(</span><em class="sig-param">a: torch.Tensor</em>, <em class="sig-param">sub: Iterable</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pathflowai/losses.html#sset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.sset" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/utils.py">https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/utils.py</a></p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.losses.uniq">
<code class="sig-prename descclassname">pathflowai.losses.</code><code class="sig-name descname">uniq</code><span class="sig-paren">(</span><em class="sig-param">a: torch.Tensor</em><span class="sig-paren">)</span> &#x2192; Set<a class="reference internal" href="_modules/pathflowai/losses.html#uniq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.losses.uniq" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/utils.py">https://raw.githubusercontent.com/LIVIAETS/surface-loss/master/utils.py</a></p>
</dd></dl>

</div>
<span class="target" id="module-pathflowai.models"></span><div class="section" id="models-py">
<h2>models.py<a class="headerlink" href="#models-py" title="Permalink to this headline">¶</a></h2>
<p>Houses all of the PyTorch models to access and the corresponding Scikit-Learn like model trainer.</p>
<dl class="class">
<dt id="pathflowai.models.FixedSegmentationModule">
<em class="property">class </em><code class="sig-prename descclassname">pathflowai.models.</code><code class="sig-name descname">FixedSegmentationModule</code><span class="sig-paren">(</span><em class="sig-param">segnet</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#FixedSegmentationModule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.FixedSegmentationModule" title="Permalink to this definition">¶</a></dt>
<dd><p>Special model modification for segmentation tasks. Gets output from some of the models’ forward loops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>segnet</strong> (<em>nn.Module</em>) – Segmentation network</p>
</dd>
</dl>
<dl class="method">
<dt id="pathflowai.models.FixedSegmentationModule.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#FixedSegmentationModule.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.FixedSegmentationModule.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Input</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Output from model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pathflowai.models.MLP">
<em class="property">class </em><code class="sig-prename descclassname">pathflowai.models.</code><code class="sig-name descname">MLP</code><span class="sig-paren">(</span><em class="sig-param">n_input</em>, <em class="sig-param">hidden_topology</em>, <em class="sig-param">dropout_p</em>, <em class="sig-param">n_outputs=1</em>, <em class="sig-param">binary=True</em>, <em class="sig-param">softmax=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#MLP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.MLP" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-layer perceptron model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_input</strong> (<em>int</em>) – Number input dimensions.</p></li>
<li><p><strong>hidden_topology</strong> (<em>list</em>) – List of hidden topology</p></li>
<li><p><strong>dropout_p</strong> (<em>float</em>) – Amount dropout.</p></li>
<li><p><strong>n_outputs</strong> (<em>int</em>) – Number outputs.</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – Binary output with sigmoid transform.</p></li>
<li><p><strong>softmax</strong> (<em>bool</em>) – Whether to apply softmax on output.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pathflowai.models.MLP.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#MLP.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.MLP.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pathflowai.models.ModelTrainer">
<em class="property">class </em><code class="sig-prename descclassname">pathflowai.models.</code><code class="sig-name descname">ModelTrainer</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">n_epoch=300</em>, <em class="sig-param">validation_dataloader=None</em>, <em class="sig-param">optimizer_opts={'lr': 0.001</em>, <em class="sig-param">'name': 'adam'</em>, <em class="sig-param">'weight_decay': 0.0001}</em>, <em class="sig-param">scheduler_opts={'T_max': 10</em>, <em class="sig-param">'T_mult': 2</em>, <em class="sig-param">'eta_min': 5e-08</em>, <em class="sig-param">'lr_scheduler_decay': 0.5</em>, <em class="sig-param">'scheduler': 'warm_restarts'}</em>, <em class="sig-param">loss_fn='ce'</em>, <em class="sig-param">reduction='mean'</em>, <em class="sig-param">num_train_batches=None</em>, <em class="sig-param">seg_out_class=-1</em>, <em class="sig-param">apex_opt_level='O2'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Trainer for the neural network model that wraps it into a scikit-learn like interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>nn.Module</em>) – Deep learning pytorch model.</p></li>
<li><p><strong>n_epoch</strong> (<em>int</em>) – Number training epochs.</p></li>
<li><p><strong>validation_dataloader</strong> (<em>DataLoader</em>) – Dataloader of validation dataset.</p></li>
<li><p><strong>optimizer_opts</strong> (<em>dict</em>) – Options for optimizer.</p></li>
<li><p><strong>scheduler_opts</strong> (<em>dict</em>) – Options for learning rate scheduler.</p></li>
<li><p><strong>loss_fn</strong> (<em>str</em>) – String to call a particular loss function for model.</p></li>
<li><p><strong>reduction</strong> (<em>str</em>) – Mean or sum reduction of loss.</p></li>
<li><p><strong>num_train_batches</strong> (<em>int</em>) – Number of training batches for epoch.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pathflowai.models.ModelTrainer.add_class_balance_loss">
<code class="sig-name descname">add_class_balance_loss</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">custom_weights=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer.add_class_balance_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer.add_class_balance_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates loss function to handle class imbalance by weighting inverse to class appearance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<a class="reference internal" href="#pathflowai.datasets.DynamicImageDataset" title="pathflowai.datasets.DynamicImageDataset"><em>DynamicImageDataset</em></a>) – Dataset to balance by.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.models.ModelTrainer.calc_best_confusion">
<code class="sig-name descname">calc_best_confusion</code><span class="sig-paren">(</span><em class="sig-param">y_pred</em>, <em class="sig-param">y_true</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer.calc_best_confusion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer.calc_best_confusion" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate confusion matrix on validation set for classification/segmentation tasks, optimize threshold where positive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong> (<em>array</em>) – Predictions.</p></li>
<li><p><strong>y_true</strong> (<em>array</em>) – Ground truth.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>float</em> – Optimized threshold to use on test set.</p></li>
<li><p><em>dataframe</em> – Confusion matrix.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.models.ModelTrainer.calc_loss">
<code class="sig-name descname">calc_loss</code><span class="sig-paren">(</span><em class="sig-param">y_pred</em>, <em class="sig-param">y_true</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer.calc_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer.calc_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates loss supplied in init statement and modified by reweighting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong> (<em>tensor</em>) – Predictions.</p></li>
<li><p><strong>y_true</strong> (<em>tensor</em>) – True values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>loss</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.models.ModelTrainer.calc_val_loss">
<code class="sig-name descname">calc_val_loss</code><span class="sig-paren">(</span><em class="sig-param">y_pred</em>, <em class="sig-param">y_true</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer.calc_val_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer.calc_val_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates loss supplied in init statement on validation set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong> (<em>tensor</em>) – Predictions.</p></li>
<li><p><strong>y_true</strong> (<em>tensor</em>) – True values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>val_loss</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.models.ModelTrainer.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">train_dataloader</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">print_every=10</em>, <em class="sig-param">save_model=True</em>, <em class="sig-param">plot_training_curves=False</em>, <em class="sig-param">plot_save_file=None</em>, <em class="sig-param">print_val_confusion=True</em>, <em class="sig-param">save_val_predictions=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the segmentation or classification model to the patches, saving the model with the lowest validation score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_dataloader</strong> (<em>DataLoader</em>) – Training dataset.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Print training and validation loss?</p></li>
<li><p><strong>print_every</strong> (<em>int</em>) – Number of epochs until print?</p></li>
<li><p><strong>save_model</strong> (<em>bool</em>) – Whether to save model when reaching lowest validation loss.</p></li>
<li><p><strong>plot_training_curves</strong> (<em>bool</em>) – Plot training curves over epochs.</p></li>
<li><p><strong>plot_save_file</strong> (<em>str</em>) – File to save training curves.</p></li>
<li><p><strong>print_val_confusion</strong> (<em>bool</em>) – Print validation confusion matrix.</p></li>
<li><p><strong>save_val_predictions</strong> (<em>bool</em>) – Print validation results.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>self</em> – Trainer.</p></li>
<li><p><em>float</em> – Minimum val loss.</p></li>
<li><p><em>int</em> – Best validation epoch with lowest loss.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.models.ModelTrainer.fit_predict">
<code class="sig-name descname">fit_predict</code><span class="sig-paren">(</span><em class="sig-param">train_dataloader</em>, <em class="sig-param">test_dataloader</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer.fit_predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer.fit_predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model to training data and make classification segmentation predictions on testing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_dataloader</strong> (<em>DataLoader</em>) – Train data.</p></li>
<li><p><strong>test_dataloader</strong> (<em>DataLoader</em>) – Test data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Predictions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.models.ModelTrainer.loss_backward">
<code class="sig-name descname">loss_backward</code><span class="sig-paren">(</span><em class="sig-param">loss</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer.loss_backward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer.loss_backward" title="Permalink to this definition">¶</a></dt>
<dd><p>Backprop using mixed precision for added speed boost.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>loss</strong> (<em>loss</em>) – Torch loss calculated.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.models.ModelTrainer.plot_train_val_curves">
<code class="sig-name descname">plot_train_val_curves</code><span class="sig-paren">(</span><em class="sig-param">save_file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer.plot_train_val_curves"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer.plot_train_val_curves" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots training and validation curves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>save_file</strong> (<em>str</em>) – File to save to.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.models.ModelTrainer.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">test_dataloader</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Make classification segmentation predictions on testing data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>test_dataloader</strong> (<em>DataLoader</em>) – Test data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Predictions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.models.ModelTrainer.reset_loss_fn">
<code class="sig-name descname">reset_loss_fn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer.reset_loss_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer.reset_loss_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets loss to original specified loss.</p>
</dd></dl>

<dl class="method">
<dt id="pathflowai.models.ModelTrainer.return_model">
<code class="sig-name descname">return_model</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer.return_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer.return_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns pytorch model.</p>
</dd></dl>

<dl class="method">
<dt id="pathflowai.models.ModelTrainer.test_loop">
<code class="sig-name descname">test_loop</code><span class="sig-paren">(</span><em class="sig-param">test_dataloader</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer.test_loop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer.test_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate final predictions on loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>test_dataloader</strong> (<em>DataLoader</em>) – Test dataset.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Predictions or embeddings.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.models.ModelTrainer.train_loop">
<code class="sig-name descname">train_loop</code><span class="sig-paren">(</span><em class="sig-param">epoch</em>, <em class="sig-param">train_dataloader</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer.train_loop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer.train_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>One training epoch, calculate predictions, loss, backpropagate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<em>int</em>) – Current epoch.</p></li>
<li><p><strong>train_dataloader</strong> (<em>DataLoader</em>) – Training data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Training loss for epoch</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.models.ModelTrainer.val_loop">
<code class="sig-name descname">val_loop</code><span class="sig-paren">(</span><em class="sig-param">epoch</em>, <em class="sig-param">val_dataloader</em>, <em class="sig-param">print_val_confusion=True</em>, <em class="sig-param">save_predictions=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#ModelTrainer.val_loop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.ModelTrainer.val_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate loss over validation set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<em>int</em>) – Current epoch.</p></li>
<li><p><strong>val_dataloader</strong> (<em>DataLoader</em>) – Validation iterator.</p></li>
<li><p><strong>print_val_confusion</strong> (<em>bool</em>) – Calculate confusion matrix and plot.</p></li>
<li><p><strong>save_predictions</strong> (<em>int</em>) – Print validation results.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Validation loss for epoch.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pathflowai.models.dice_loss">
<code class="sig-prename descclassname">pathflowai.models.</code><code class="sig-name descname">dice_loss</code><span class="sig-paren">(</span><em class="sig-param">logits</em>, <em class="sig-param">true</em>, <em class="sig-param">eps=1e-07</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#dice_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.dice_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Sørensen–Dice loss.</p>
<p>PyTorch optimizers minimize loss. In this case, we would like to maximize
the dice loss so we return the negated dice loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>true</strong> – A tensor of shape [B, 1, H, W].</p></li>
<li><p><strong>logit</strong> – A tensor of shape [B, C, H, W]. Corresponds to the raw output or
logits of the model.</p></li>
<li><p><strong>eps</strong> – Added to the denominator for numerical stability.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the Sørensen–Dice loss.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dice_loss</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><a class="reference external" href="https://github.com/kevinzakka/pytorch-goodies">https://github.com/kevinzakka/pytorch-goodies</a></p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.models.generate_model">
<code class="sig-prename descclassname">pathflowai.models.</code><code class="sig-name descname">generate_model</code><span class="sig-paren">(</span><em class="sig-param">pretrain</em>, <em class="sig-param">architecture</em>, <em class="sig-param">num_classes</em>, <em class="sig-param">add_sigmoid=True</em>, <em class="sig-param">n_hidden=100</em>, <em class="sig-param">segmentation=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/models.html#generate_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.models.generate_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a nn.Module for use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pretrain</strong> (<em>bool</em>) – Pretrain using ImageNet?</p></li>
<li><p><strong>architecture</strong> (<em>str</em>) – See model_training for list of all architectures you can train with.</p></li>
<li><p><strong>num_classes</strong> (<em>int</em>) – Number of classes to predict.</p></li>
<li><p><strong>add_sigmoid</strong> (<em>type</em>) – Add sigmoid non-linearity at end.</p></li>
<li><p><strong>n_hidden</strong> (<em>int</em>) – Number of hidden fully connected layers.</p></li>
<li><p><strong>segmentation</strong> (<em>bool</em>) – Whether segment task?</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pytorch model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-pathflowai.sampler"></span><div class="section" id="sampler-py">
<h2>sampler.py<a class="headerlink" href="#sampler-py" title="Permalink to this headline">¶</a></h2>
<p>Balanced sampling based on one of the columns of the patch information.</p>
<dl class="class">
<dt id="pathflowai.sampler.ImbalancedDatasetSampler">
<em class="property">class </em><code class="sig-prename descclassname">pathflowai.sampler.</code><code class="sig-name descname">ImbalancedDatasetSampler</code><span class="sig-paren">(</span><em class="sig-param">dataset</em>, <em class="sig-param">indices=None</em>, <em class="sig-param">num_samples=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/sampler.html#ImbalancedDatasetSampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.sampler.ImbalancedDatasetSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Samples elements randomly from a given list of indices.</p>
<p>This is useful for imbalanced datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>list of int</em><em>, </em><em>optional</em>) – A list of indices.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of samples to draw.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><a class="reference external" href="https://raw.githubusercontent.com/ufoym/imbalanced-dataset-sampler/master/sampler.py">https://raw.githubusercontent.com/ufoym/imbalanced-dataset-sampler/master/sampler.py</a></p>
</dd></dl>

</div>
<span class="target" id="module-pathflowai.schedulers"></span><div class="section" id="schedulers-py">
<h2>schedulers.py<a class="headerlink" href="#schedulers-py" title="Permalink to this headline">¶</a></h2>
<p>Modulates the learning rate during the training process.</p>
<dl class="class">
<dt id="pathflowai.schedulers.CosineAnnealingWithRestartsLR">
<em class="property">class </em><code class="sig-prename descclassname">pathflowai.schedulers.</code><code class="sig-name descname">CosineAnnealingWithRestartsLR</code><span class="sig-paren">(</span><em class="sig-param">optimizer</em>, <em class="sig-param">T_max</em>, <em class="sig-param">eta_min=0</em>, <em class="sig-param">last_epoch=-1</em>, <em class="sig-param">T_mult=1.0</em>, <em class="sig-param">alpha_decay=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/schedulers.html#CosineAnnealingWithRestartsLR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.schedulers.CosineAnnealingWithRestartsLR" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the learning rate of each parameter group using cosine annealing.</p>
<p>It has been proposed in <a href="#id8"><span class="problematic" id="id5">[1]_</span></a>. This implements the cosine annealing schedule
part of SGDR, the restarts, and the multiplier for the number of
iterations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> (<em>Optimizer</em>) – The wrapped optimizer.</p></li>
<li><p><strong>T_max</strong> (<em>int</em>) – Maximum number of iterations.</p></li>
<li><p><strong>T_mult</strong> (<em>float</em><em>, </em><em>optional</em>) – Multiply T_max by this number after each restart. The default is 1,
which signifies no change in T_max after each restart.</p></li>
<li><p><strong>eta_min</strong> (<em>float</em><em>, </em><em>optional</em>) – The minimum learning rate. The default is 0.</p></li>
<li><p><strong>last_epoch</strong> (<em>int</em>) – The index of the last epoch. The default is -1, which sets the
initial learning rate to the learning rate.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><span class="math notranslate nohighlight">\(\eta_{max}\)</span> is set to the initial learning rate and <span class="math notranslate nohighlight">\(T_{cur}\)</span>
is the number of epochs since the last restart in SGDR:
.. math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">eta_t</span> <span class="o">=</span> \<span class="n">eta_</span><span class="p">{</span><span class="nb">min</span><span class="p">}</span> <span class="o">+</span> \<span class="n">frac</span><span class="p">{</span><span class="mi">1</span><span class="p">}{</span><span class="mi">2</span><span class="p">}(</span>\<span class="n">eta_</span><span class="p">{</span><span class="nb">max</span><span class="p">}</span> <span class="o">-</span> \<span class="n">eta_</span><span class="p">{</span><span class="nb">min</span><span class="p">})(</span><span class="mi">1</span> <span class="o">+</span> \<span class="n">cos</span><span class="p">(</span>\<span class="n">frac</span><span class="p">{</span><span class="n">T_</span><span class="p">{</span><span class="n">cur</span><span class="p">}}{</span><span class="n">T_</span><span class="p">{</span><span class="nb">max</span><span class="p">}}</span>\<span class="n">pi</span><span class="p">))</span>
</pre></div>
</div>
<p>When <cite>last_epoch</cite> is -1, the initial learning rate is set to the learning
rate.</p>
<dl class="footnote brackets">
<dt class="label" id="id6"><span class="brackets">1</span></dt>
<dd><p>Loshchilov, Ilya, and Frank Hutter. “SGDR: Stochastic Gradient
Descent with Warm Restarts.” ArXiv:1608.03983 [Cs, Math], May 2017.
arXiv.org, http://arxiv.org/abs/1608.03983.</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="pathflowai.schedulers.Scheduler">
<em class="property">class </em><code class="sig-prename descclassname">pathflowai.schedulers.</code><code class="sig-name descname">Scheduler</code><span class="sig-paren">(</span><em class="sig-param">optimizer=None</em>, <em class="sig-param">opts={'T_max': 10</em>, <em class="sig-param">'T_mult': 2</em>, <em class="sig-param">'eta_min': 5e-08</em>, <em class="sig-param">'lr_scheduler_decay': 0.5</em>, <em class="sig-param">'scheduler': 'null'}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/schedulers.html#Scheduler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.schedulers.Scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Scheduler class that modulates learning rate of torch optimizers over epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> (<em>type</em>) – torch.Optimizer object</p></li>
<li><p><strong>opts</strong> (<em>type</em>) – Options of setting the learning rate scheduler, see default.</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="pathflowai.schedulers.Scheduler.schedulers">
<code class="sig-name descname">schedulers</code><a class="headerlink" href="#pathflowai.schedulers.Scheduler.schedulers" title="Permalink to this definition">¶</a></dt>
<dd><p>Different types of schedulers to choose from.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>type</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pathflowai.schedulers.Scheduler.scheduler_step_fn">
<code class="sig-name descname">scheduler_step_fn</code><a class="headerlink" href="#pathflowai.schedulers.Scheduler.scheduler_step_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>How scheduler updates learning rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>type</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pathflowai.schedulers.Scheduler.initial_lr">
<code class="sig-name descname">initial_lr</code><a class="headerlink" href="#pathflowai.schedulers.Scheduler.initial_lr" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial set learning rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>type</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pathflowai.schedulers.Scheduler.scheduler_choice">
<code class="sig-name descname">scheduler_choice</code><a class="headerlink" href="#pathflowai.schedulers.Scheduler.scheduler_choice" title="Permalink to this definition">¶</a></dt>
<dd><p>What scheduler type was chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>type</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pathflowai.schedulers.Scheduler.scheduler">
<code class="sig-name descname">scheduler</code><a class="headerlink" href="#pathflowai.schedulers.Scheduler.scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Scheduler object chosen that will more directly update optimizer LR.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>type</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.schedulers.Scheduler.get_lr">
<code class="sig-name descname">get_lr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/schedulers.html#Scheduler.get_lr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.schedulers.Scheduler.get_lr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return current learning rate.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Current learning rate.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.schedulers.Scheduler.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/schedulers.html#Scheduler.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.schedulers.Scheduler.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Update optimizer learning rate</p>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-pathflowai.visualize"></span><div class="section" id="visualize-py">
<h2>visualize.py<a class="headerlink" href="#visualize-py" title="Permalink to this headline">¶</a></h2>
<p>Plots SHAP outputs, UMAP embeddings, and overlays predictions on top of WSI.</p>
<dl class="class">
<dt id="pathflowai.visualize.PlotlyPlot">
<em class="property">class </em><code class="sig-prename descclassname">pathflowai.visualize.</code><code class="sig-name descname">PlotlyPlot</code><a class="reference internal" href="_modules/pathflowai/visualize.html#PlotlyPlot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.PlotlyPlot" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates plotly html plots.</p>
<dl class="method">
<dt id="pathflowai.visualize.PlotlyPlot.add_plot">
<code class="sig-name descname">add_plot</code><span class="sig-paren">(</span><em class="sig-param">t_data_df, G=None, color_col='color', name_col='name', xyz_cols=['x', 'y', 'z'], size=2, opacity=1.0, custom_colors=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#PlotlyPlot.add_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.PlotlyPlot.add_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds plotting data to be plotted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_data_df</strong> (<em>dataframe</em>) – 3-D transformed dataframe.</p></li>
<li><p><strong>G</strong> (<em>nx.Graph</em>) – Networkx graph.</p></li>
<li><p><strong>color_col</strong> (<em>str</em>) – Column to use to color points.</p></li>
<li><p><strong>name_col</strong> (<em>str</em>) – Column to use to name points.</p></li>
<li><p><strong>xyz_cols</strong> (<em>list</em>) – 3 columns that denote x,y,z coords.</p></li>
<li><p><strong>size</strong> (<em>int</em>) – Marker size.</p></li>
<li><p><strong>opacity</strong> (<em>float</em>) – Marker opacity.</p></li>
<li><p><strong>custom_colors</strong> (<em>list</em>) – Custom colors to supply.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.visualize.PlotlyPlot.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">output_fname</em>, <em class="sig-param">axes_off=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#PlotlyPlot.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.PlotlyPlot.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot embedding of patches to html file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_fname</strong> (<em>str</em>) – Output html file.</p></li>
<li><p><strong>axes_off</strong> (<em>bool</em>) – Remove axes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pathflowai.visualize.PredictionPlotter">
<em class="property">class </em><code class="sig-prename descclassname">pathflowai.visualize.</code><code class="sig-name descname">PredictionPlotter</code><span class="sig-paren">(</span><em class="sig-param">dask_arr_dict</em>, <em class="sig-param">patch_info_db</em>, <em class="sig-param">compression_factor=3</em>, <em class="sig-param">alpha=0.5</em>, <em class="sig-param">patch_size=224</em>, <em class="sig-param">no_db=False</em>, <em class="sig-param">plot_annotation=False</em>, <em class="sig-param">segmentation=False</em>, <em class="sig-param">n_segmentation_classes=4</em>, <em class="sig-param">input_dir=''</em>, <em class="sig-param">annotation_col='annotation'</em>, <em class="sig-param">scaling_factor=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#PredictionPlotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.PredictionPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots predictions over entire image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dask_arr_dict</strong> (<em>dict</em>) – Stores all dask arrays corresponding to all of the images.</p></li>
<li><p><strong>patch_info_db</strong> (<em>str</em>) – Patch level information, eg. prediction.</p></li>
<li><p><strong>compression_factor</strong> (<em>float</em>) – How much to compress image by.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Low value assigns higher weight to prediction over original image.</p></li>
<li><p><strong>patch_size</strong> (<em>int</em>) – Patch size.</p></li>
<li><p><strong>no_db</strong> (<em>bool</em>) – Don’t use patch information.</p></li>
<li><p><strong>plot_annotation</strong> (<em>bool</em>) – Plot annotations from patch information.</p></li>
<li><p><strong>segmentation</strong> (<em>bool</em>) – Plot segmentation mask.</p></li>
<li><p><strong>n_segmentation_classes</strong> (<em>int</em>) – Number segmentation classes.</p></li>
<li><p><strong>input_dir</strong> (<em>str</em>) – Input directory.</p></li>
<li><p><strong>annotation_col</strong> (<em>str</em>) – Annotation column to plot.</p></li>
<li><p><strong>scaling_factor</strong> (<em>float</em>) – Multiplies the prediction scores to make them appear darker on the images when predicting.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pathflowai.visualize.PredictionPlotter.add_custom_segmentation">
<code class="sig-name descname">add_custom_segmentation</code><span class="sig-paren">(</span><em class="sig-param">basename</em>, <em class="sig-param">npy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#PredictionPlotter.add_custom_segmentation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.PredictionPlotter.add_custom_segmentation" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace segmentation mask with new custom segmentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basename</strong> (<em>str</em>) – Patient ID</p></li>
<li><p><strong>npy</strong> (<em>str</em>) – Numpy mask.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.visualize.PredictionPlotter.generate_image">
<code class="sig-name descname">generate_image</code><span class="sig-paren">(</span><em class="sig-param">ID</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#PredictionPlotter.generate_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.PredictionPlotter.generate_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the image array for the whole slide image with predictions overlaid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ID</strong> (<em>str</em>) – patient ID.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Resulting overlaid whole slide image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.visualize.PredictionPlotter.output_image">
<code class="sig-name descname">output_image</code><span class="sig-paren">(</span><em class="sig-param">img</em>, <em class="sig-param">filename</em>, <em class="sig-param">tif=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#PredictionPlotter.output_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.PredictionPlotter.output_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Output calculated image to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>array</em>) – Image.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Output file name.</p></li>
<li><p><strong>tif</strong> (<em>bool</em>) – Store in TIF format?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pathflowai.visualize.PredictionPlotter.return_patch">
<code class="sig-name descname">return_patch</code><span class="sig-paren">(</span><em class="sig-param">ID</em>, <em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">patch_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#PredictionPlotter.return_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.PredictionPlotter.return_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return one single patch instead of entire image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ID</strong> (<em>str</em>) – Patient ID</p></li>
<li><p><strong>x</strong> (<em>int</em>) – X coordinate.</p></li>
<li><p><strong>y</strong> (<em>int</em>) – Y coordinate.</p></li>
<li><p><strong>patch_size</strong> (<em>int</em>) – Patch size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pathflowai.visualize.annotation2rgb">
<code class="sig-prename descclassname">pathflowai.visualize.</code><code class="sig-name descname">annotation2rgb</code><span class="sig-paren">(</span><em class="sig-param">i</em>, <em class="sig-param">palette</em>, <em class="sig-param">arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#annotation2rgb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.annotation2rgb" title="Permalink to this definition">¶</a></dt>
<dd><p>Go from annotation of patch to color.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>) – Annotation index.</p></li>
<li><p><strong>palette</strong> (<em>palette</em>) – Index to color mapping.</p></li>
<li><p><strong>arr</strong> (<em>array</em>) – Image array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Resulting image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.visualize.blend">
<code class="sig-prename descclassname">pathflowai.visualize.</code><code class="sig-name descname">blend</code><span class="sig-paren">(</span><em class="sig-param">arr1</em>, <em class="sig-param">arr2</em>, <em class="sig-param">alpha=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#blend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.blend" title="Permalink to this definition">¶</a></dt>
<dd><p>Blend 2 arrays together, mixing with alpha.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr1</strong> (<em>array</em>) – Image 1.</p></li>
<li><p><strong>arr2</strong> (<em>array</em>) – Image 2.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Higher alpha makes image more like image 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Resulting image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.visualize.plot_image_">
<code class="sig-prename descclassname">pathflowai.visualize.</code><code class="sig-name descname">plot_image_</code><span class="sig-paren">(</span><em class="sig-param">image_file</em>, <em class="sig-param">compression_factor=2.0</em>, <em class="sig-param">test_image_name='test.png'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#plot_image_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.plot_image_" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots entire SVS/other image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Image file.</p></li>
<li><p><strong>compression_factor</strong> (<em>float</em>) – Amount to shrink each dimension of image.</p></li>
<li><p><strong>test_image_name</strong> (<em>str</em>) – Output image file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.visualize.plot_shap">
<code class="sig-prename descclassname">pathflowai.visualize.</code><code class="sig-name descname">plot_shap</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">dataset_opts</em>, <em class="sig-param">transform_opts</em>, <em class="sig-param">batch_size</em>, <em class="sig-param">outputfilename</em>, <em class="sig-param">n_outputs=1</em>, <em class="sig-param">method='deep'</em>, <em class="sig-param">local_smoothing=0.0</em>, <em class="sig-param">n_samples=20</em>, <em class="sig-param">pred_out=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#plot_shap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.plot_shap" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot shapley attributions overlaid on images for classification tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>nn.Module</em>) – Pytorch model.</p></li>
<li><p><strong>dataset_opts</strong> (<em>dict</em>) – Options used to configure dataset</p></li>
<li><p><strong>transform_opts</strong> (<em>dict</em>) – Options used to configure transformers.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size for training.</p></li>
<li><p><strong>outputfilename</strong> (<em>str</em>) – Output filename.</p></li>
<li><p><strong>n_outputs</strong> (<em>int</em>) – Number of top outputs.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Gradient or deep explainer.</p></li>
<li><p><strong>local_smoothing</strong> (<em>float</em>) – How much to smooth shapley map.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number shapley samples to draw.</p></li>
<li><p><strong>pred_out</strong> (<em>bool</em>) – Label images with binary prediction score?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.visualize.plot_umap_images">
<code class="sig-prename descclassname">pathflowai.visualize.</code><code class="sig-name descname">plot_umap_images</code><span class="sig-paren">(</span><em class="sig-param">dask_arr_dict</em>, <em class="sig-param">embeddings_file</em>, <em class="sig-param">ID=None</em>, <em class="sig-param">cval=1.0</em>, <em class="sig-param">image_res=300.0</em>, <em class="sig-param">outputfname='output_embedding.png'</em>, <em class="sig-param">mpl_scatter=True</em>, <em class="sig-param">remove_background_annotation=''</em>, <em class="sig-param">max_background_area=0.01</em>, <em class="sig-param">zoom=0.05</em>, <em class="sig-param">n_neighbors=10</em>, <em class="sig-param">sort_col=''</em>, <em class="sig-param">sort_mode='asc'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#plot_umap_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.plot_umap_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Make UMAP embedding plot, overlaid with images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dask_arr_dict</strong> (<em>dict</em>) – Stored dask arrays for each WSI.</p></li>
<li><p><strong>embeddings_file</strong> (<em>str</em>) – Embeddings pickle file stored from running using after trainign the model.</p></li>
<li><p><strong>ID</strong> (<em>str</em>) – Patient ID.</p></li>
<li><p><strong>cval</strong> (<em>float</em>) – Deprecated</p></li>
<li><p><strong>image_res</strong> (<em>float</em>) – Image resolution.</p></li>
<li><p><strong>outputfname</strong> (<em>str</em>) – Output image file.</p></li>
<li><p><strong>mpl_scatter</strong> (<em>bool</em>) – Recommended: Use matplotlib for scatter plot.</p></li>
<li><p><strong>remove_background_annotation</strong> (<em>str</em>) – Remove the background annotations. Enter for annotation to remove.</p></li>
<li><p><strong>max_background_area</strong> (<em>float</em>) – Maximum backgrund area in each tile for inclusion.</p></li>
<li><p><strong>zoom</strong> (<em>float</em>) – How much to zoom in on each patch, less than 1 is zoom out.</p></li>
<li><p><strong>n_neighbors</strong> (<em>int</em>) – Number of neighbors for UMAP embedding.</p></li>
<li><p><strong>sort_col</strong> (<em>str</em>) – Patch info column to sort on.</p></li>
<li><p><strong>sort_mode</strong> (<em>str</em>) – Sort ascending or descending.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>type</em> – Description of returned object.</p></li>
<li><p><strong>Inspired by</strong> (<em>https://gist.github.com/lukemetz/be6123c7ee3b366e333a</em>)</p></li>
<li><p><em>WIP!! Needs testing.</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.visualize.prob2rbg">
<code class="sig-prename descclassname">pathflowai.visualize.</code><code class="sig-name descname">prob2rbg</code><span class="sig-paren">(</span><em class="sig-param">prob</em>, <em class="sig-param">palette</em>, <em class="sig-param">arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#prob2rbg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.prob2rbg" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert probability score to rgb image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prob</strong> (<em>float</em>) – Between 0 and 1 score.</p></li>
<li><p><strong>palette</strong> (<em>palette</em>) – Pallet converts between prob and color.</p></li>
<li><p><strong>arr</strong> (<em>array</em>) – Original array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New image colored by prediction score.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.visualize.seg2rgb">
<code class="sig-prename descclassname">pathflowai.visualize.</code><code class="sig-name descname">seg2rgb</code><span class="sig-paren">(</span><em class="sig-param">seg</em>, <em class="sig-param">palette</em>, <em class="sig-param">n_segmentation_classes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#seg2rgb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.seg2rgb" title="Permalink to this definition">¶</a></dt>
<dd><p>Color each pixel by segmentation class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seg</strong> (<em>array</em>) – Segmentation mask.</p></li>
<li><p><strong>palette</strong> (<em>palette</em>) – Color to RGB map.</p></li>
<li><p><strong>n_segmentation_classes</strong> (<em>int</em>) – Total number segmentation classes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returned segmentation image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.visualize.to_pil">
<code class="sig-prename descclassname">pathflowai.visualize.</code><code class="sig-name descname">to_pil</code><span class="sig-paren">(</span><em class="sig-param">arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/visualize.html#to_pil"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.visualize.to_pil" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy array to pil.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>array</em>) – Numpy array.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>PIL Image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Image</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-pathflowai.utils"></span><div class="section" id="utils-py">
<h2>utils.py<a class="headerlink" href="#utils-py" title="Permalink to this headline">¶</a></h2>
<p>General utilities that still need to be broken up into preprocessing, machine learning input preparation, and output submodules.</p>
<dl class="function">
<dt id="pathflowai.utils.add_purple_mask">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">add_purple_mask</code><span class="sig-paren">(</span><em class="sig-param">arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#add_purple_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.add_purple_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional add intensity mask to the dask array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>dask.array</em>) – Image data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Image data with intensity added as forth channel.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.adjust_mask">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">adjust_mask</code><span class="sig-paren">(</span><em class="sig-param">mask_file</em>, <em class="sig-param">dask_img_array_file</em>, <em class="sig-param">out_npy</em>, <em class="sig-param">n_neighbors</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#adjust_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.adjust_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixes segmentation masks to reduce coarse annotations over empty regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask_file</strong> (<em>str</em>) – NPY segmentation mask.</p></li>
<li><p><strong>dask_img_array_file</strong> (<em>str</em>) – Dask image file.</p></li>
<li><p><strong>out_npy</strong> (<em>str</em>) – Output numpy file.</p></li>
<li><p><strong>n_neighbors</strong> (<em>int</em>) – Number nearest neighbors for dilation and erosion of mask from background to not background.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Output numpy file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.boxes2interior">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">boxes2interior</code><span class="sig-paren">(</span><em class="sig-param">img_size</em>, <em class="sig-param">polygons</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#boxes2interior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.boxes2interior" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated.</p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.create_purple_mask">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">create_purple_mask</code><span class="sig-paren">(</span><em class="sig-param">arr</em>, <em class="sig-param">img_size=None</em>, <em class="sig-param">sparse=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#create_purple_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.create_purple_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a gray scale intensity mask. This will be changed soon to support other thresholding QC methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>dask.array</em>) – Dask array containing image information.</p></li>
<li><p><strong>img_size</strong> (<em>int</em>) – Deprecated.</p></li>
<li><p><strong>sparse</strong> (<em>bool</em>) – Deprecated</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Intensity, grayscale array over image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dask.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.create_sparse_annotation_arrays">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">create_sparse_annotation_arrays</code><span class="sig-paren">(</span><em class="sig-param">xml_file</em>, <em class="sig-param">img_size</em>, <em class="sig-param">annotations=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#create_sparse_annotation_arrays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.create_sparse_annotation_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert annotation xml to shapely objects and store in dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xml_file</strong> (<em>str</em>) – XML file containing annotations.</p></li>
<li><p><strong>img_size</strong> (<em>int</em>) – Deprecated.</p></li>
<li><p><strong>annotations</strong> (<em>list</em>) – Annotations to look for in xml export.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary with annotation-shapely object pairs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.create_train_val_test">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">create_train_val_test</code><span class="sig-paren">(</span><em class="sig-param">train_val_test_pkl</em>, <em class="sig-param">input_info_db</em>, <em class="sig-param">patch_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#create_train_val_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.create_train_val_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Create dataframe that splits slides into training validation and test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_val_test_pkl</strong> (<em>str</em>) – Pickle for training validation and test slides.</p></li>
<li><p><strong>input_info_db</strong> (<em>str</em>) – Patch information SQL database.</p></li>
<li><p><strong>patch_size</strong> (<em>int</em>) – Patch size looking to access.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Train test validation splits.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.df2sql">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">df2sql</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">sql_file</em>, <em class="sig-param">patch_size</em>, <em class="sig-param">mode='replace'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#df2sql"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.df2sql" title="Permalink to this definition">¶</a></dt>
<dd><p>Write dataframe containing patch level information to SQL db.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>dataframe</em>) – Dataframe containing patch information.</p></li>
<li><p><strong>sql_file</strong> (<em>str</em>) – SQL database.</p></li>
<li><p><strong>patch_size</strong> (<em>int</em>) – The size of the patches.</p></li>
<li><p><strong>mode</strong> (<em>{'replace'</em><em>, </em><em>'append'}</em>) – If the replace mode is used, the the SQL database’s previous
content is deleted. If the append mode is used, the SQL database’s
previous information remains intact.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.dir2images">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">dir2images</code><span class="sig-paren">(</span><em class="sig-param">image_dir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#dir2images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.dir2images" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated</p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.extract_patch_information">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">extract_patch_information</code><span class="sig-paren">(</span><em class="sig-param">basename</em>, <em class="sig-param">input_dir='./'</em>, <em class="sig-param">annotations=[]</em>, <em class="sig-param">threshold=0.5</em>, <em class="sig-param">patch_size=224</em>, <em class="sig-param">generate_finetune_segmentation=False</em>, <em class="sig-param">target_class=0</em>, <em class="sig-param">intensity_threshold=100.0</em>, <em class="sig-param">target_threshold=0.0</em>, <em class="sig-param">adj_mask=''</em>, <em class="sig-param">basic_preprocess=False</em>, <em class="sig-param">tries=0</em>, <em class="sig-param">entire_image=False</em>, <em class="sig-param">svs_file=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#extract_patch_information"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.extract_patch_information" title="Permalink to this definition">¶</a></dt>
<dd><p>Final step of preprocessing pipeline. Break up image into patches, include if not background and of a certain intensity, find area of each annotation type in patch, spatial information, image ID and dump data to SQL table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basename</strong> (<em>str</em>) – Patient ID.</p></li>
<li><p><strong>input_dir</strong> (<em>str</em>) – Input directory.</p></li>
<li><p><strong>annotations</strong> (<em>list</em>) – List of annotations to record, these can be different tissue types, must correspond with XML labels.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Value between 0 and 1 that indicates the minimum amount of patch that musn’t be background for inclusion.</p></li>
<li><p><strong>patch_size</strong> (<em>int</em>) – Patch size of patches; this will become one of the tables.</p></li>
<li><p><strong>generate_finetune_segmentation</strong> (<em>bool</em>) – Deprecated.</p></li>
<li><p><strong>target_class</strong> (<em>int</em>) – Number of segmentation classes desired, from 0th class to target_class-1 will be annotated in SQL.</p></li>
<li><p><strong>intensity_threshold</strong> (<em>float</em>) – Value between 0 and 255 that represents minimum intensity to not include as background. Will be modified with new transforms.</p></li>
<li><p><strong>target_threshold</strong> (<em>float</em>) – Deprecated.</p></li>
<li><p><strong>adj_mask</strong> (<em>str</em>) – Adjusted mask if performed binary opening operations in previous preprocessing step.</p></li>
<li><p><strong>basic_preprocess</strong> (<em>bool</em>) – Do not store patch level information.</p></li>
<li><p><strong>tries</strong> (<em>int</em>) – Number of tries in case there is a Dask timeout, run again.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Patch information.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.fix_name">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">fix_name</code><span class="sig-paren">(</span><em class="sig-param">basename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#fix_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.fix_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixes illegitimate basename, deprecated.</p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.fix_names">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">fix_names</code><span class="sig-paren">(</span><em class="sig-param">file_dir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#fix_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.fix_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixes basenames, deprecated.</p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.generate_patch_pipeline">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">generate_patch_pipeline</code><span class="sig-paren">(</span><em class="sig-param">basename</em>, <em class="sig-param">input_dir='./'</em>, <em class="sig-param">annotations=[]</em>, <em class="sig-param">threshold=0.5</em>, <em class="sig-param">patch_size=224</em>, <em class="sig-param">out_db='patch_info.db'</em>, <em class="sig-param">generate_finetune_segmentation=False</em>, <em class="sig-param">target_class=0</em>, <em class="sig-param">intensity_threshold=100.0</em>, <em class="sig-param">target_threshold=0.0</em>, <em class="sig-param">adj_mask=''</em>, <em class="sig-param">basic_preprocess=False</em>, <em class="sig-param">entire_image=False</em>, <em class="sig-param">svs_file=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#generate_patch_pipeline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.generate_patch_pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Find area coverage of each annotation in each patch and store patch information into SQL db.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basename</strong> (<em>str</em>) – Patient ID.</p></li>
<li><p><strong>input_dir</strong> (<em>str</em>) – Input directory.</p></li>
<li><p><strong>annotations</strong> (<em>list</em>) – List of annotations to record, these can be different tissue types, must correspond with XML labels.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Value between 0 and 1 that indicates the minimum amount of patch that musn’t be background for inclusion.</p></li>
<li><p><strong>patch_size</strong> (<em>int</em>) – Patch size of patches; this will become one of the tables.</p></li>
<li><p><strong>out_db</strong> (<em>str</em>) – Output SQL database.</p></li>
<li><p><strong>generate_finetune_segmentation</strong> (<em>bool</em>) – Deprecated.</p></li>
<li><p><strong>target_class</strong> (<em>int</em>) – Number of segmentation classes desired, from 0th class to target_class-1 will be annotated in SQL.</p></li>
<li><p><strong>intensity_threshold</strong> (<em>float</em>) – Value between 0 and 255 that represents minimum intensity to not include as background. Will be modified with new transforms.</p></li>
<li><p><strong>target_threshold</strong> (<em>float</em>) – Deprecated.</p></li>
<li><p><strong>adj_mask</strong> (<em>str</em>) – Adjusted mask if performed binary opening operations in previous preprocessing step.</p></li>
<li><p><strong>basic_preprocess</strong> (<em>bool</em>) – Do not store patch level information.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.grab_interior_points">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">grab_interior_points</code><span class="sig-paren">(</span><em class="sig-param">xml_file</em>, <em class="sig-param">img_size</em>, <em class="sig-param">annotations=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#grab_interior_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.grab_interior_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated.</p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.image2coords">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">image2coords</code><span class="sig-paren">(</span><em class="sig-param">image_file</em>, <em class="sig-param">output_point=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#image2coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.image2coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated.</p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.images2coord_dict">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">images2coord_dict</code><span class="sig-paren">(</span><em class="sig-param">images</em>, <em class="sig-param">output_point=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#images2coord_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.images2coord_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated</p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.img2npy_">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">img2npy_</code><span class="sig-paren">(</span><em class="sig-param">input_dir</em>, <em class="sig-param">basename</em>, <em class="sig-param">svs_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#img2npy_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.img2npy_" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert SVS, TIF, TIFF to NPY.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dir</strong> (<em>str</em>) – Output file dir.</p></li>
<li><p><strong>basename</strong> (<em>str</em>) – Basename of output file</p></li>
<li><p><strong>svs_file</strong> (<em>str</em>) – SVS, TIF, TIFF file input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>NPY output file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.is_coords_in_box">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">is_coords_in_box</code><span class="sig-paren">(</span><em class="sig-param">coords</em>, <em class="sig-param">patch_size</em>, <em class="sig-param">boxes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#is_coords_in_box"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.is_coords_in_box" title="Permalink to this definition">¶</a></dt>
<dd><p>Get area of annotation in patch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>array</em>) – X,Y coordinates of patch.</p></li>
<li><p><strong>patch_size</strong> (<em>int</em>) – Patch size.</p></li>
<li><p><strong>boxes</strong> (<em>list</em>) – Shapely objects for annotations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Area of annotation type.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.is_image_in_boxes">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">is_image_in_boxes</code><span class="sig-paren">(</span><em class="sig-param">image_coord_dict</em>, <em class="sig-param">boxes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#is_image_in_boxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.is_image_in_boxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Find if image intersects with annotations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_coord_dict</strong> (<em>dict</em>) – Dictionary of patches.</p></li>
<li><p><strong>boxes</strong> (<em>list</em>) – Shapely annotation shapes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary of whether image intersects with any of the annotations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.is_valid_patch">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">is_valid_patch</code><span class="sig-paren">(</span><em class="sig-param">xs</em>, <em class="sig-param">ys</em>, <em class="sig-param">patch_size</em>, <em class="sig-param">purple_mask</em>, <em class="sig-param">intensity_threshold</em>, <em class="sig-param">threshold=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#is_valid_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.is_valid_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated, computes whether patch is valid.</p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.load_dataset">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">load_dataset</code><span class="sig-paren">(</span><em class="sig-param">in_zarr</em>, <em class="sig-param">in_pkl</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#load_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.load_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Load ZARR image and annotations pickle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_zarr</strong> (<em>str</em>) – Input image.</p></li>
<li><p><strong>in_pkl</strong> (<em>str</em>) – Input annotations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>dask.array</em> – Image array.</p></li>
<li><p><em>dict</em> – Annotations dictionary.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.load_process_image">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">load_process_image</code><span class="sig-paren">(</span><em class="sig-param">svs_file</em>, <em class="sig-param">xml_file=None</em>, <em class="sig-param">npy_mask=None</em>, <em class="sig-param">annotations=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#load_process_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.load_process_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Load SVS-like image (including NPY), segmentation/classification annotations, generate dask array and dictionary of annotations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>svs_file</strong> (<em>str</em>) – Image file</p></li>
<li><p><strong>xml_file</strong> (<em>str</em>) – Annotation file.</p></li>
<li><p><strong>npy_mask</strong> (<em>array</em>) – Numpy segmentation mask.</p></li>
<li><p><strong>annotations</strong> (<em>list</em>) – List of annotations in xml.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>array</em> – Dask array of image.</p></li>
<li><p><em>dict</em> – Annotation masks.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.load_sql_df">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">load_sql_df</code><span class="sig-paren">(</span><em class="sig-param">sql_file</em>, <em class="sig-param">patch_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#load_sql_df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.load_sql_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Load pandas dataframe from SQL, accessing particular patch size within SQL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sql_file</strong> (<em>str</em>) – SQL db.</p></li>
<li><p><strong>patch_size</strong> (<em>int</em>) – Patch size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Patch level information.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.modify_patch_info">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">modify_patch_info</code><span class="sig-paren">(</span><em class="sig-param">input_info_db='patch_info.db'</em>, <em class="sig-param">slide_labels=Empty DataFrame Columns: [] Index: []</em>, <em class="sig-param">pos_annotation_class=''</em>, <em class="sig-param">patch_size=224</em>, <em class="sig-param">segmentation=False</em>, <em class="sig-param">other_annotations=[]</em>, <em class="sig-param">target_segmentation_class=-1</em>, <em class="sig-param">target_threshold=0.0</em>, <em class="sig-param">classify_annotations=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#modify_patch_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.modify_patch_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify the patch information to get ready for deep learning, incorporate whole slide labels if needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_info_db</strong> (<em>str</em>) – SQL DB file.</p></li>
<li><p><strong>slide_labels</strong> (<em>dataframe</em>) – Dataframe with whole slide labels.</p></li>
<li><p><strong>pos_annotation_class</strong> (<em>str</em>) – Tissue/annotation label to label with whole slide image label, if not supplied, any slide’s patches receive the whole slide label.</p></li>
<li><p><strong>patch_size</strong> (<em>int</em>) – Patch size.</p></li>
<li><p><strong>segmentation</strong> (<em>bool</em>) – Segmentation?</p></li>
<li><p><strong>other_annotations</strong> (<em>list</em>) – Other annotations to access from patch information.</p></li>
<li><p><strong>target_segmentation_class</strong> (<em>int</em>) – Segmentation class to threshold.</p></li>
<li><p><strong>target_threshold</strong> (<em>float</em>) – Include patch if patch has target area greater than this.</p></li>
<li><p><strong>classify_annotations</strong> (<em>bool</em>) – Classifying annotations for pretraining, or final model?</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Modified patch information.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.npy2da">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">npy2da</code><span class="sig-paren">(</span><em class="sig-param">npy_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#npy2da"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.npy2da" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy to dask array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>npy_file</strong> (<em>str</em>) – Input npy file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Converted numpy array to dask.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dask.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.parse_coord_return_boxes">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">parse_coord_return_boxes</code><span class="sig-paren">(</span><em class="sig-param">xml_file</em>, <em class="sig-param">annotation_name=''</em>, <em class="sig-param">return_coords=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#parse_coord_return_boxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.parse_coord_return_boxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get list of shapely objects for each annotation in the XML object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xml_file</strong> (<em>str</em>) – Annotation file.</p></li>
<li><p><strong>annotation_name</strong> (<em>str</em>) – Name of xml annotation.</p></li>
<li><p><strong>return_coords</strong> (<em>bool</em>) – Just return list of coords over shapes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of shapely objects.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.process_svs">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">process_svs</code><span class="sig-paren">(</span><em class="sig-param">svs_file</em>, <em class="sig-param">xml_file</em>, <em class="sig-param">annotations=[]</em>, <em class="sig-param">output_dir='./'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#process_svs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.process_svs" title="Permalink to this definition">¶</a></dt>
<dd><p>Store images into npy format and store annotations into pickle dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>svs_file</strong> (<em>str</em>) – Image file.</p></li>
<li><p><strong>xml_file</strong> (<em>str</em>) – Annotations file.</p></li>
<li><p><strong>annotations</strong> (<em>list</em>) – List of annotations in image.</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Output directory.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.retain_images">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">retain_images</code><span class="sig-paren">(</span><em class="sig-param">image_dir</em>, <em class="sig-param">xml_file</em>, <em class="sig-param">annotation=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#retain_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.retain_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated</p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.return_image_coord">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">return_image_coord</code><span class="sig-paren">(</span><em class="sig-param">nx=0</em>, <em class="sig-param">ny=0</em>, <em class="sig-param">xl=3333</em>, <em class="sig-param">yl=3333</em>, <em class="sig-param">xi=0</em>, <em class="sig-param">yi=0</em>, <em class="sig-param">xc=3</em>, <em class="sig-param">yc=3</em>, <em class="sig-param">dimx=224</em>, <em class="sig-param">dimy=224</em>, <em class="sig-param">output_point=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#return_image_coord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.return_image_coord" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated</p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.return_image_in_boxes_dict">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">return_image_in_boxes_dict</code><span class="sig-paren">(</span><em class="sig-param">image_dir</em>, <em class="sig-param">xml_file</em>, <em class="sig-param">annotation=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#return_image_in_boxes_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.return_image_in_boxes_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated</p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.run_preprocessing_pipeline">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">run_preprocessing_pipeline</code><span class="sig-paren">(</span><em class="sig-param">svs_file</em>, <em class="sig-param">xml_file=None</em>, <em class="sig-param">npy_mask=None</em>, <em class="sig-param">annotations=[]</em>, <em class="sig-param">out_zarr='output_zarr.zarr'</em>, <em class="sig-param">out_pkl='output.pkl'</em>, <em class="sig-param">no_zarr=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#run_preprocessing_pipeline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.run_preprocessing_pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Run preprocessing pipeline. Store image into zarr format, segmentations maintain as npy, and xml annotations as pickle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>svs_file</strong> (<em>str</em>) – Input image file.</p></li>
<li><p><strong>xml_file</strong> (<em>str</em>) – Input annotation file.</p></li>
<li><p><strong>npy_mask</strong> (<em>str</em>) – NPY segmentation mask.</p></li>
<li><p><strong>annotations</strong> (<em>list</em>) – List of annotations.</p></li>
<li><p><strong>out_zarr</strong> (<em>str</em>) – Output zarr for image.</p></li>
<li><p><strong>out_pkl</strong> (<em>str</em>) – Output pickle for annotations.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.save_all_patch_info">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">save_all_patch_info</code><span class="sig-paren">(</span><em class="sig-param">basenames</em>, <em class="sig-param">input_dir='./'</em>, <em class="sig-param">annotations=[]</em>, <em class="sig-param">threshold=0.5</em>, <em class="sig-param">patch_size=224</em>, <em class="sig-param">output_pkl='patch_info.pkl'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#save_all_patch_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.save_all_patch_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Deprecated.</p>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.save_dataset">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">save_dataset</code><span class="sig-paren">(</span><em class="sig-param">arr</em>, <em class="sig-param">masks</em>, <em class="sig-param">out_zarr</em>, <em class="sig-param">out_pkl</em>, <em class="sig-param">no_zarr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#save_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.save_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves dask array image, dictionary of annotations to zarr and pickle respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>array</em>) – Image.</p></li>
<li><p><strong>masks</strong> (<em>dict</em>) – Dictionary of annotation shapes.</p></li>
<li><p><strong>out_zarr</strong> (<em>str</em>) – Zarr output file for image.</p></li>
<li><p><strong>out_pkl</strong> (<em>str</em>) – Pickle output file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.segmentation_predictions2npy">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">segmentation_predictions2npy</code><span class="sig-paren">(</span><em class="sig-param">y_pred</em>, <em class="sig-param">patch_info</em>, <em class="sig-param">segmentation_map</em>, <em class="sig-param">npy_output</em>, <em class="sig-param">original_patch_size=500</em>, <em class="sig-param">resized_patch_size=256</em>, <em class="sig-param">output_probs=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#segmentation_predictions2npy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.segmentation_predictions2npy" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert segmentation predictions from model to numpy masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred</strong> (<em>list</em>) – List of patch segmentation masks</p></li>
<li><p><strong>patch_info</strong> (<em>dataframe</em>) – Patch information from DB.</p></li>
<li><p><strong>segmentation_map</strong> (<em>array</em>) – Existing segmentation mask.</p></li>
<li><p><strong>npy_output</strong> (<em>str</em>) – Output npy file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pathflowai.utils.svs2dask_array">
<code class="sig-prename descclassname">pathflowai.utils.</code><code class="sig-name descname">svs2dask_array</code><span class="sig-paren">(</span><em class="sig-param">svs_file</em>, <em class="sig-param">tile_size=1000</em>, <em class="sig-param">overlap=0</em>, <em class="sig-param">remove_last=True</em>, <em class="sig-param">allow_unknown_chunksizes=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pathflowai/utils.html#svs2dask_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pathflowai.utils.svs2dask_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert SVS, TIF or TIFF to dask array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>svs_file</strong> (<em>str</em>) – The path to the image file.</p></li>
<li><p><strong>tile_size</strong> (<em>int</em><em>, </em><em>optinal</em>) – The size of the chunk to be read in.</p></li>
<li><p><strong>overlap</strong> (<em>int</em><em>, </em><em>optional</em>) – Do not modify, overlap between neighboring tiles.</p></li>
<li><p><strong>remove_last</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to remove the last tile because it has a custom size.</p></li>
<li><p><strong>allow_unknown_chunksizes</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to allow different chunk sizes. If True, flexibility
increases, but this method becomes slower. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>arr</strong> – A Dask Array representing the contents of the image file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dask.array.Array</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pathflowai.utils</span> <span class="kn">import</span> <span class="n">svs2dask_array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">svs2dask_array</span><span class="p">(</span><span class="n">svs_file</span><span class="p">,</span> <span class="n">tile_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">overlap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">remove_last</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_unknown_chunksizes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">arr2</span><span class="p">,</span> <span class="n">dsize</span><span class="o">=</span><span class="p">(</span><span class="mi">1440</span><span class="p">,</span> <span class="mi">700</span><span class="p">),</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">INTER_CUBIC</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr3</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">test_image_name</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Joshua Levy

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>